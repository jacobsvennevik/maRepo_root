{"version":3,"sources":["/Users/jacobhornsvennevik/Documents/GitHub/maRepo_root/frontend/src/lib/axios-auth.ts"],"sourcesContent":["import axios from \"axios\";\n\n// Auth client for token endpoints\nexport const axiosAuth = axios.create({ \n  baseURL: \"/backend/api\", \n  withCredentials: false,\n  timeout: 30000,\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n});\n\n// Simple request interceptor for auth (verbose debug logging, with redaction)\naxiosAuth.interceptors.request.use(\n  (config) => {\n    try {\n      const method = config.method?.toUpperCase();\n      const base = config.baseURL ?? '';\n      const url = typeof config.url === 'string' ? config.url : '';\n      const fullUrl = (() => {\n        try { return new URL(url, base).toString(); } catch { return `${base}${url}`; }\n      })();\n      const body = (() => {\n        if (!config.data) return undefined;\n        try {\n          const d = typeof config.data === 'string' ? JSON.parse(config.data) : config.data;\n          if (d && typeof d === 'object') {\n            const clone = { ...d };\n            if ('password' in clone) clone.password = '***REDACTED***';\n            if ('refresh' in clone) clone.refresh = `${String(clone.refresh).slice(0, 6)}…`;\n            return clone;\n          }\n          return d;\n        } catch {\n          return '[unserializable body]';\n        }\n      })();\n      console.log('[axiosAuth] → Request', { method, url, fullUrl, baseURL: base, data: body });\n    } catch (e) {\n      console.log('[axiosAuth] → Request');\n    }\n    return config;\n  },\n  (error) => {\n    console.error(\"Auth request error:\", error);\n    return Promise.reject(error);\n  }\n);\n\n// Simple response interceptor for auth (verbose debug logging)\naxiosAuth.interceptors.response.use(\n  (response) => {\n    try {\n      const base = response.config.baseURL ?? '';\n      const url = typeof response.config.url === 'string' ? response.config.url : '';\n      const fullUrl = (() => {\n        try { return new URL(url, base).toString(); } catch { return `${base}${url}`; }\n      })();\n      const preview = typeof response.data === 'string' ? response.data.slice(0, 200) : response.data;\n      console.log('[axiosAuth] ← Response', { status: response.status, url, fullUrl, dataPreview: preview });\n    } catch {\n      console.log(`[axiosAuth] ← Response ${response.status} ${response.config.url}`);\n    }\n    return response;\n  },\n  (error) => {\n    try {\n      const status = error?.response?.status;\n      const base = error?.config?.baseURL ?? '';\n      const url = typeof error?.config?.url === 'string' ? error?.config?.url : '';\n      const fullUrl = (() => { try { return new URL(url, base).toString(); } catch { return `${base}${url}`; } })();\n      const data = error?.response?.data;\n      console.error('[axiosAuth] ✖ Error', { status, url, fullUrl, data });\n    } catch (e) {\n      console.error('Auth response error:', error);\n    }\n    return Promise.reject(error);\n  }\n);\n"],"names":["axiosAuth","axios","create","baseURL","withCredentials","timeout","headers","interceptors","request","use","config","method","toUpperCase","base","url","fullUrl","URL","toString","body","data","undefined","d","JSON","parse","clone","password","refresh","String","slice","console","log","e","error","Promise","reject","response","preview","status","dataPreview"],"mappings":"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"}