{"version":3,"sources":["/Users/jacobhornsvennevik/Documents/GitHub/maRepo_root/frontend/src/app/projects/[projectId]/flashcards/utils/data-transformation.ts"],"sourcesContent":["// Data transformation utilities for flashcard hooks\nimport { axiosGeneration } from \"@/lib/axios\";\nimport type { Paginated } from \"@/lib/api/pagination\";\n\nexport interface FlashcardSetApi {\n  id: number;\n  title: string;\n  total_cards: number;\n  due_cards: number;\n  learning_cards: number;\n  review_cards: number;\n  new_cards: number;\n  average_accuracy: number;\n  created_at: string;\n}\n\nfunction normalizeProjectId(raw: string): string {\n  const val = String(raw || \"\");\n  const looksLikeUuid = val.includes(\"-\") && val.length >= 32;\n  if (looksLikeUuid) return val;\n  // Fallback: try to read active project id stored by projects overview\n  if (typeof window !== \"undefined\" && window.localStorage) {\n    const stored = localStorage.getItem(\"activeProjectId\") || localStorage.getItem(\"currentProjectId\");\n    if (stored) return stored;\n  }\n  return val; // last resort\n}\n\nexport function unwrapFlashcardSets(payload: any): FlashcardSetApi[] {\n  return Array.isArray(payload)\n    ? payload\n    : Array.isArray(payload?.results)\n    ? payload.results\n    : [];\n}\n\nexport async function refreshFlashcardSets(projectId: string): Promise<FlashcardSetApi[]> {\n  const effectiveProjectId = normalizeProjectId(projectId);\n  const response = await axiosGeneration.get<FlashcardSetApi[] | Paginated<FlashcardSetApi>>(\n    `projects/${effectiveProjectId}/flashcard-sets/`\n  );\n  return unwrapFlashcardSets(response.data);\n}\n\nexport function calculateFlashcardStats(sets: FlashcardSetApi[]) {\n  const totalCards = sets.reduce((sum, set) => sum + set.total_cards, 0);\n  const dueToday = sets.reduce((sum, set) => sum + set.due_cards, 0);\n  const learningCards = sets.reduce((sum, set) => sum + set.learning_cards, 0);\n  const reviewCards = sets.reduce((sum, set) => sum + set.review_cards, 0);\n  const avgAccuracy = sets.length > 0\n    ? sets.reduce((sum, set) => sum + set.average_accuracy, 0) / sets.length\n    : 0;\n\n  return {\n    total_sets: sets.length,\n    total_cards: totalCards,\n    due_today: dueToday,\n    learning_cards: learningCards,\n    mastered_cards: reviewCards,\n    average_accuracy: avgAccuracy,\n  };\n}\n"],"names":["calculateFlashcardStats","refreshFlashcardSets","unwrapFlashcardSets","normalizeProjectId","raw","val","String","looksLikeUuid","includes","length","window","localStorage","stored","getItem","payload","Array","isArray","results","projectId","effectiveProjectId","response","axiosGeneration","get","data","sets","totalCards","reduce","sum","set","total_cards","dueToday","due_cards","learningCards","learning_cards","reviewCards","review_cards","avgAccuracy","average_accuracy","total_sets","due_today","mastered_cards"],"mappings":"AAAA,oDAAoD;;;;;;;;;;;;IA4CpCA,uBAAuB;eAAvBA;;IARMC,oBAAoB;eAApBA;;IARNC,mBAAmB;eAAnBA;;;uBA3BgB;AAehC,SAASC,mBAAmBC,GAAW;IACrC,MAAMC,MAAMC,OAAOF,OAAO;IAC1B,MAAMG,gBAAgBF,IAAIG,QAAQ,CAAC,QAAQH,IAAII,MAAM,IAAI;IACzD,IAAIF,eAAe,OAAOF;IAC1B,sEAAsE;IACtE,IAAI,OAAOK,WAAW,eAAeA,OAAOC,YAAY,EAAE;QACxD,MAAMC,SAASD,aAAaE,OAAO,CAAC,sBAAsBF,aAAaE,OAAO,CAAC;QAC/E,IAAID,QAAQ,OAAOA;IACrB;IACA,OAAOP,KAAK,cAAc;AAC5B;AAEO,SAASH,oBAAoBY,OAAY;IAC9C,OAAOC,MAAMC,OAAO,CAACF,WACjBA,UACAC,MAAMC,OAAO,CAACF,SAASG,WACvBH,QAAQG,OAAO,GACf,EAAE;AACR;AAEO,eAAehB,qBAAqBiB,SAAiB;IAC1D,MAAMC,qBAAqBhB,mBAAmBe;IAC9C,MAAME,WAAW,MAAMC,sBAAe,CAACC,GAAG,CACxC,CAAC,SAAS,EAAEH,mBAAmB,gBAAgB,CAAC;IAElD,OAAOjB,oBAAoBkB,SAASG,IAAI;AAC1C;AAEO,SAASvB,wBAAwBwB,IAAuB;IAC7D,MAAMC,aAAaD,KAAKE,MAAM,CAAC,CAACC,KAAKC,MAAQD,MAAMC,IAAIC,WAAW,EAAE;IACpE,MAAMC,WAAWN,KAAKE,MAAM,CAAC,CAACC,KAAKC,MAAQD,MAAMC,IAAIG,SAAS,EAAE;IAChE,MAAMC,gBAAgBR,KAAKE,MAAM,CAAC,CAACC,KAAKC,MAAQD,MAAMC,IAAIK,cAAc,EAAE;IAC1E,MAAMC,cAAcV,KAAKE,MAAM,CAAC,CAACC,KAAKC,MAAQD,MAAMC,IAAIO,YAAY,EAAE;IACtE,MAAMC,cAAcZ,KAAKf,MAAM,GAAG,IAC9Be,KAAKE,MAAM,CAAC,CAACC,KAAKC,MAAQD,MAAMC,IAAIS,gBAAgB,EAAE,KAAKb,KAAKf,MAAM,GACtE;IAEJ,OAAO;QACL6B,YAAYd,KAAKf,MAAM;QACvBoB,aAAaJ;QACbc,WAAWT;QACXG,gBAAgBD;QAChBQ,gBAAgBN;QAChBG,kBAAkBD;IACpB;AACF"}