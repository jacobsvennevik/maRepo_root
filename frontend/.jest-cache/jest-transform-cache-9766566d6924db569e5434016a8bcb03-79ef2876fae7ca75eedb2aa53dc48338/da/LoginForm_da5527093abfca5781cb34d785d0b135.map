{"version":3,"sources":["/Users/jacobhornsvennevik/Documents/GitHub/maRepo_root/frontend/src/app/(auth)/components/LoginForm.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport * as z from \"zod\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/cards/login-card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useRouter } from \"next/navigation\";\nimport { AuthService } from \"../services/auth\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { axiosApi } from \"@/lib/axios-api\";\n\nconst formSchema = z.object({\n  email: z.string().email({ message: \"Please enter a valid email address.\" }),\n  password: z\n    .string()\n    .min(8, { message: \"Password must be at least 8 characters.\" }),\n});\n\ntype FormData = z.infer<typeof formSchema>;\n\nexport function LoginForm({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [error, setError] = React.useState<string | null>(null);\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm<FormData>({\n    resolver: zodResolver(formSchema),\n  });\n  const router = useRouter();\n\n  async function onSubmit(data: FormData) {\n    setIsLoading(true);\n    setError(null);\n\n    // Add a try-catch block specifically for the login attempt\n    try {\n      // Test localStorage first\n      try {\n        localStorage.setItem(\"test-storage\", \"test\");\n        const testValue = localStorage.getItem(\"test-storage\");\n        localStorage.removeItem(\"test-storage\");\n      } catch (storageError) {\n        throw new Error(\n          \"Browser storage is not available. Please enable cookies and local storage.\",\n        );\n      }\n\n      await AuthService.login({\n        email: data.email,\n        password: data.password,\n      });\n\n      // Verify tokens were stored\n      const authToken = localStorage.getItem(\"access_token\");\n      const refreshToken = localStorage.getItem(\"refresh_token\");\n\n      if (!authToken || !refreshToken) {\n        throw new Error(\"Login succeeded but tokens were not stored\");\n      }\n\n      // Test authenticated request (through proxy client)\n      try {\n        const testResponse = await axiosApi.get(\"users/me/\");\n      } catch (testError) {}\n\n      router.push(\"/dashboard\");\n    } catch (error: any) {\n      // Set a more specific error message\n      let errorMessage = \"Login failed. Please try again.\";\n      if (error.response?.data?.detail) {\n        errorMessage = error.response.data.detail;\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n\n      setError(errorMessage);\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  return (\n    <div\n      className={cn(\"flex flex-col gap-6\", className)}\n      {...props}\n      data-testid=\"login-form\"\n    >\n      <Card className=\"overflow-hidden border-0 shadow-2xl bg-white/90 backdrop-blur-sm rounded-2xl\">\n        <CardContent className=\"grid md:grid-cols-2 gap-0 !p-0\">\n          {/* Left Column - Form */}\n          <div className=\"p-8 flex flex-col justify-center bg-slate-50/80\">\n            <div className=\"max-w-sm mx-auto w-full space-y-6\">\n              <div className=\"text-center space-y-2\">\n                <h1 className=\"text-3xl font-medium text-slate-900\">\n                  Dive into learning\n                </h1>\n                <p className=\"text-slate-600\">Sign in to your YesYes account</p>\n              </div>\n\n              {error && (\n                <Alert variant=\"destructive\">\n                  <AlertDescription>{error}</AlertDescription>\n                </Alert>\n              )}\n\n              <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"email\" className=\"text-sm text-slate-700\">\n                    Email address\n                  </Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    placeholder=\"you@example.com\"\n                    {...register(\"email\")}\n                    className={cn(\n                      \"h-11 px-3 py-2 text-base bg-white border border-slate-200\",\n                      errors.email\n                        ? \"border-red-500 focus:border-red-500\"\n                        : \"focus:border-emerald-400 focus:ring-emerald-400\",\n                    )}\n                  />\n                  {errors.email && (\n                    <p className=\"text-sm text-red-600 mt-1\">\n                      {errors.email.message}\n                    </p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center justify-between\">\n                    <Label\n                      htmlFor=\"password\"\n                      className=\"text-sm text-slate-700\"\n                    >\n                      Password\n                    </Label>\n                    {/*\n                    <Link\n                      href=\"/forgot-password\" // TODO: Update with correct route if different\n                      className=\"text-sm text-emerald-600 hover:text-emerald-700 hover:underline underline-offset-4\"\n                    >\n                      Forgot your password?\n                    </Link>\n                    */}\n                  </div>\n                  <Input\n                    id=\"password\"\n                    type=\"password\"\n                    {...register(\"password\")}\n                    className=\"h-11 px-3 py-2 text-base bg-white border border-slate-200 focus:border-emerald-400 focus:ring-emerald-400\"\n                  />\n                  {errors.password && (\n                    <p className=\"text-sm text-red-600\">\n                      {errors.password.message}\n                    </p>\n                  )}\n                </div>\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full h-11 bg-emerald-600 hover:bg-emerald-700 text-white font-medium\"\n                  disabled={isLoading}\n                >\n                  {isLoading ? \"Signing in...\" : \"Sign in\"}\n                </Button>\n              </form>\n\n              <div className=\"relative\">\n                <div className=\"absolute inset-0 flex items-center\">\n                  <div className=\"w-full border-t border-slate-200\"></div>\n                </div>\n                <div className=\"relative flex justify-center text-sm\">\n                  <span className=\"px-2 bg-slate-50 text-slate-500\">\n                    Or continue with\n                  </span>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-3 gap-3\">\n                <Button\n                  variant=\"outline\"\n                  className=\"h-11 px-0 border border-slate-200 hover:bg-slate-50 hover:text-emerald-600\"\n                >\n                  <svg\n                    className=\"h-5 w-5\"\n                    aria-hidden=\"true\"\n                    fill=\"currentColor\"\n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path d=\"M12.152 6.896c-.948 0-2.415-1.078-3.96-1.04-2.04.027-3.91 1.183-4.961 3.014-2.117 3.675-.546 9.103 1.519 12.09 1.013 1.454 2.208 3.09 3.792 3.039 1.52-.065 2.09-.987 3.935-.987 1.831 0 2.35.987 3.96.948 1.637-.026 2.676-1.48 3.676-2.948 1.156-1.688 1.636-3.325 1.662-3.415-.039-.013-3.182-1.221-3.22-4.857-.026-3.04 2.48-4.494 2.597-4.559-1.429-2.09-3.623-2.324-4.39-2.376-2-.156-3.675 1.09-4.61 1.09zM15.53 3.83c.843-1.012 1.4-2.427 1.245-3.83-1.207.052-2.662.805-3.532 1.818-.78.896-1.454 2.338-1.273 3.714 1.338.104 2.715-.688 3.559-1.701\" />\n                  </svg>\n                  <span className=\"sr-only\">Sign in with Apple</span>\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"h-11 px-0 border border-slate-200 hover:bg-slate-50 hover:text-emerald-600\"\n                >\n                  <svg\n                    className=\"h-5 w-5\"\n                    aria-hidden=\"true\"\n                    fill=\"currentColor\"\n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path d=\"M12.48 10.92v3.28h7.84c-.24 1.84-.853 3.187-1.787 4.133-1.147 1.147-2.933 2.4-6.053 2.4-4.827 0-8.6-3.893-8.6-8.72s3.773-8.72 8.6-8.72c2.6 0 4.507 1.027 5.907 2.347l2.307-2.307C18.747 1.44 16.133 0 12.48 0 5.867 0 .307 5.387.307 12s5.56 12 12.173 12c3.573 0 6.267-1.173 8.373-3.36 2.16-2.16 2.84-5.213 2.84-7.667 0-.76-.053-1.467-.173-2.053H12.48z\" />\n                  </svg>\n                  <span className=\"sr-only\">Sign in with Google</span>\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"h-11 px-0 border border-slate-200 hover:bg-slate-50 hover:text-emerald-600\"\n                >\n                  <svg\n                    className=\"h-5 w-5\"\n                    aria-hidden=\"true\"\n                    fill=\"currentColor\"\n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path d=\"M6.915 4.03c-1.968 0-3.683 1.28-4.871 3.113C.704 9.208 0 11.883 0 14.449c0 .706.07 1.369.21 1.973a6.624 6.624 0 0 0 .265.86 5.297 5.297 0 0 0 .371.761c.696 1.159 1.818 1.927 3.593 1.927 1.497 0 2.633-.671 3.965-2.444.76-1.012 1.144-1.626 2.663-4.32l.756-1.339.186-.325c.061.1.121.196.183.3l2.152 3.595c.724 1.21 1.665 2.556 2.47 3.314 1.046.987 1.992 1.22 3.06 1.22 1.075 0 1.876-.355 2.455-.843a3.743 3.743 0 0 0 .81-.973c.542-.939.861-2.127.861-3.745 0-2.72-.681-5.357-2.084-7.45-1.282-1.912-2.957-2.93-4.716-2.93-1.047 0-2.088.467-3.053 1.308-.652.57-1.257 1.29-1.82 2.05-.69-.875-1.335-1.547-1.958-2.056-1.182-.966-2.315-1.303-3.454-1.303zm10.16 2.053c1.147 0 2.188.758 2.992 1.999 1.132 1.748 1.647 4.195 1.647 6.4 0 1.548-.368 2.9-1.839 2.9-.58 0-1.027-.23-1.664-1.004-.496-.601-1.343-1.878-2.832-4.358l-.617-1.028a44.908 44.908 0 0 0-1.255-1.98c.07-.109.141-.224.211-.327 1.12-1.667 2.118-2.602 3.358-2.602zm-10.201.553c1.265 0 2.058.791 2.675 1.446.307.327.737.871 1.234 1.579l-1.02 1.566c-.757 1.163-1.882 3.017-2.837 4.338-1.191 1.649-1.81 1.817-2.486 1.817-.524 0-1.038-.237-1.383-.794-.263-.426-.464-1.13-.464-2.046 0-2.221.63-4.535 1.66-6.088.454-.687.964-1.226 1.533-1.533a2.264 2.264 0 0 1 1.088-.285z\" />\n                  </svg>\n                  <span className=\"sr-only\">Sign in with Meta</span>\n                </Button>\n              </div>\n\n              <div className=\"text-center text-sm\">\n                <span className=\"text-slate-600\">Don't have an account? </span>\n                <Link\n                  href=\"/signup\"\n                  className=\"text-emerald-600 hover:text-emerald-700 hover:underline underline-offset-4\"\n                >\n                  Sign up\n                </Link>\n              </div>\n            </div>\n          </div>\n\n          {/* Right Column - Image */}\n          <div className=\"relative aspect-[4/3] md:aspect-auto md:h-full\">\n            <Image\n              src=\"/images/seashore.jpg\"\n              alt=\"Ocean waves\"\n              fill\n              className=\"object-cover\"\n              priority\n            />\n            <div className=\"absolute inset-0 bg-gradient-to-br from-emerald-400/80 to-blue-500/80 mix-blend-multiply\"></div>\n            <div className=\"absolute inset-0 flex flex-col items-center justify-center p-8 text-white\">\n              <div className=\"max-w-md text-center\">\n                <h2 className=\"text-3xl font-medium mb-4\">\n                  Explore the depths of knowledge\n                </h2>\n                <p className=\"text-lg text-white/90\">\n                  Our AI-powered platform transforms the way you learn with\n                  personalized study experiences\n                </p>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <div className=\"text-center text-xs text-slate-500 mt-6\">\n        By clicking continue, you agree to our{\" \"}\n        <a\n          href=\"#\"\n          className=\"underline hover:text-emerald-600 underline-offset-4\"\n        >\n          Terms of Service\n        </a>{\" \"}\n        and{\" \"}\n        <a\n          href=\"#\"\n          className=\"underline hover:text-emerald-600 underline-offset-4\"\n        >\n          Privacy Policy\n        </a>\n        .\n      </div>\n    </div>\n  );\n}\n"],"names":["LoginForm","formSchema","z","object","email","string","message","password","min","className","props","isLoading","setIsLoading","React","useState","error","setError","register","handleSubmit","formState","errors","useForm","resolver","zodResolver","router","useRouter","onSubmit","data","localStorage","setItem","testValue","getItem","removeItem","storageError","Error","AuthService","login","authToken","refreshToken","testResponse","axiosApi","get","testError","push","errorMessage","response","detail","div","cn","data-testid","Card","CardContent","h1","p","Alert","variant","AlertDescription","form","Label","htmlFor","Input","id","type","placeholder","Button","disabled","span","svg","aria-hidden","fill","viewBox","path","d","Link","href","Image","src","alt","priority","h2","a"],"mappings":"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"}