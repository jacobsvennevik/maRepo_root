501051573a84f37ff169e71d82ffe32f
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    createTestCleanup: function() {
        return createTestCleanup;
    },
    setupAPITestEnvironment: function() {
        return setupAPITestEnvironment;
    },
    setupComponentTestEnvironment: function() {
        return setupComponentTestEnvironment;
    },
    setupEnvironmentTest: function() {
        return setupEnvironmentTest;
    },
    setupFileUploadTestEnvironment: function() {
        return setupFileUploadTestEnvironment;
    },
    setupFullTestEnvironment: function() {
        return setupFullTestEnvironment;
    },
    setupGlobalTestEnvironment: function() {
        return setupGlobalTestEnvironment;
    },
    setupNavigationTestEnvironment: function() {
        return setupNavigationTestEnvironment;
    },
    setupPerformanceTest: function() {
        return setupPerformanceTest;
    }
});
const _globals = require("@jest/globals");
const _react = require("@testing-library/react");
const _mocks = require("../mocks");
const _factories = require("../factories");
const setupGlobalTestEnvironment = (options = {})=>{
    const { timeout = 10000, includeMSW = true, includeStorage = true, includeNavigation = true, includeAPI = true, resetMocks = true } = options;
    // Set global timeout
    jest.setTimeout(timeout);
    (0, _globals.beforeAll)(()=>{
        // Setup all mocks
        if (includeAPI) {
            _mocks.standardMocks.setupAll();
        }
        if (includeStorage) {
            _mocks.standardMocks.fileSystemMocks.setupStorageMocks();
        }
        // Setup MSW if needed
        if (includeMSW) {
            // MSW setup will be handled by the MSW setup file
            console.log('MSW setup handled by setup file');
        }
    });
    (0, _globals.beforeEach)(()=>{
        // Reset all mocks before each test
        if (resetMocks) {
            jest.clearAllMocks();
            _mocks.standardMocks.resetAll();
        }
        // Cleanup React Testing Library
        (0, _react.cleanup)();
    });
    (0, _globals.afterEach)(()=>{
        // Additional cleanup if needed
        jest.clearAllTimers();
    });
    (0, _globals.afterAll)(()=>{
        // Global cleanup
        _mocks.standardMocks.resetAll();
    });
};
const setupComponentTestEnvironment = (componentName)=>{
    (0, _globals.beforeEach)(()=>{
        // Component-specific setup
        console.log(`Setting up test environment for ${componentName}`);
    });
    (0, _globals.afterEach)(()=>{
        // Component-specific cleanup
        (0, _react.cleanup)();
    });
};
const setupAPITestEnvironment = ()=>{
    const { apiMocks } = _mocks.standardMocks;
    (0, _globals.beforeEach)(()=>{
        // Reset API mocks
        apiMocks.reset();
        // Setup default successful responses
        apiMocks.setupMockResponses({
            'POST:/backend/api/upload/': {
                ok: true,
                status: 200,
                json: async ()=>({
                        id: 123,
                        status: 'pending'
                    })
            },
            'GET:/backend/api/analysis/123/': {
                ok: true,
                status: 200,
                json: async ()=>({
                        id: 123,
                        status: 'completed',
                        original_text: 'Mock analysis result'
                    })
            }
        });
    });
    return {
        mockFetch: apiMocks.mockFetch,
        setupMockResponses: apiMocks.setupMockResponses,
        mockNetworkError: apiMocks.mockNetworkError,
        mockTimeout: apiMocks.mockTimeout
    };
};
const setupFileUploadTestEnvironment = ()=>{
    const { fileSystemMocks } = _mocks.standardMocks;
    const { createFileUploadTest } = _factories.testFactories;
    (0, _globals.beforeEach)(()=>{
        // Setup file system mocks
        fileSystemMocks.setupStorageMocks();
        // Reset file system mocks
        fileSystemMocks.reset();
    });
    const createTestFile = (options = {})=>{
        return createFileUploadTest(options);
    };
    const createMultipleTestFiles = (count, options = {})=>{
        return Array.from({
            length: count
        }, (_, index)=>createFileUploadTest({
                fileName: `test${index + 1}.pdf`,
                ...options
            }));
    };
    return {
        createTestFile,
        createMultipleTestFiles,
        mockLocalStorage: fileSystemMocks.mockLocalStorage,
        mockSessionStorage: fileSystemMocks.mockSessionStorage,
        mockFileReader: fileSystemMocks.mockFileReader
    };
};
const setupNavigationTestEnvironment = ()=>{
    const { navigationMocks } = _mocks.standardMocks;
    (0, _globals.beforeEach)(()=>{
        // Reset navigation mocks
        navigationMocks.reset();
    });
    return {
        mockRouter: navigationMocks.mockRouter,
        mockUseRouter: navigationMocks.mockUseRouter,
        mockUsePathname: navigationMocks.mockUsePathname,
        mockUseSearchParams: navigationMocks.mockUseSearchParams
    };
};
const setupEnvironmentTest = (env = {})=>{
    const { environmentMocks } = _mocks.standardMocks;
    const originalEnv = process.env;
    (0, _globals.beforeEach)(()=>{
        // Set test environment
        environmentMocks.mockEnvironment({
            NODE_ENV: 'test',
            NEXT_PUBLIC_TEST_MODE: 'true',
            ...env
        });
    });
    (0, _globals.afterEach)(()=>{
        // Reset environment
        environmentMocks.resetEnvironment();
    });
    return {
        setEnv: environmentMocks.mockEnvironment,
        resetEnv: environmentMocks.resetEnvironment
    };
};
const setupFullTestEnvironment = (options = {})=>{
    const apiEnv = setupAPITestEnvironment();
    const fileEnv = setupFileUploadTestEnvironment();
    const navEnv = setupNavigationTestEnvironment();
    const envTest = setupEnvironmentTest();
    // Setup global environment
    setupGlobalTestEnvironment(options);
    return {
        api: apiEnv,
        files: fileEnv,
        navigation: navEnv,
        environment: envTest,
        mocks: _mocks.standardMocks,
        factories: _factories.testFactories
    };
};
const createTestCleanup = ()=>{
    const cleanupFunctions = [];
    const addCleanup = (fn)=>{
        cleanupFunctions.push(fn);
    };
    const runCleanup = ()=>{
        cleanupFunctions.forEach((fn)=>{
            try {
                fn();
            } catch (error) {
                console.warn('Cleanup function failed:', error);
            }
        });
        cleanupFunctions.length = 0;
    };
    (0, _globals.afterEach)(()=>{
        runCleanup();
    });
    return {
        addCleanup,
        runCleanup
    };
};
const setupPerformanceTest = ()=>{
    const startTime = Date.now();
    const measurements = {};
    const startMeasurement = (name)=>{
        measurements[name] = Date.now();
    };
    const endMeasurement = (name)=>{
        const duration = Date.now() - measurements[name];
        console.log(`Performance: ${name} took ${duration}ms`);
        return duration;
    };
    const getTotalTime = ()=>Date.now() - startTime;
    return {
        startMeasurement,
        endMeasurement,
        getTotalTime
    };
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYWNvYmhvcm5zdmVubmV2aWsvRG9jdW1lbnRzL0dpdEh1Yi9tYVJlcG9fcm9vdC9mcm9udGVuZC9zcmMvdGVzdC11dGlscy9zZXR1cC9zaGFyZWQtc2V0dXAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYmVmb3JlQWxsLCBiZWZvcmVFYWNoLCBhZnRlckVhY2gsIGFmdGVyQWxsIH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgeyBjbGVhbnVwIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgeyBzdGFuZGFyZE1vY2tzIH0gZnJvbSAnLi4vbW9ja3MnO1xuaW1wb3J0IHsgdGVzdEZhY3RvcmllcyB9IGZyb20gJy4uL2ZhY3Rvcmllcyc7XG5cbi8qKlxuICogU2hhcmVkIHRlc3QgZW52aXJvbm1lbnQgc2V0dXAgYW5kIHRlYXJkb3duIHV0aWxpdGllc1xuICovXG5cbmludGVyZmFjZSBUZXN0RW52aXJvbm1lbnRPcHRpb25zIHtcbiAgdGltZW91dD86IG51bWJlcjtcbiAgaW5jbHVkZU1TVz86IGJvb2xlYW47XG4gIGluY2x1ZGVTdG9yYWdlPzogYm9vbGVhbjtcbiAgaW5jbHVkZU5hdmlnYXRpb24/OiBib29sZWFuO1xuICBpbmNsdWRlQVBJPzogYm9vbGVhbjtcbiAgcmVzZXRNb2Nrcz86IGJvb2xlYW47XG59XG5cbi8qKlxuICogR2xvYmFsIHRlc3QgZW52aXJvbm1lbnQgc2V0dXBcbiAqL1xuZXhwb3J0IGNvbnN0IHNldHVwR2xvYmFsVGVzdEVudmlyb25tZW50ID0gKG9wdGlvbnM6IFRlc3RFbnZpcm9ubWVudE9wdGlvbnMgPSB7fSkgPT4ge1xuICBjb25zdCB7XG4gICAgdGltZW91dCA9IDEwMDAwLFxuICAgIGluY2x1ZGVNU1cgPSB0cnVlLFxuICAgIGluY2x1ZGVTdG9yYWdlID0gdHJ1ZSxcbiAgICBpbmNsdWRlTmF2aWdhdGlvbiA9IHRydWUsXG4gICAgaW5jbHVkZUFQSSA9IHRydWUsXG4gICAgcmVzZXRNb2NrcyA9IHRydWVcbiAgfSA9IG9wdGlvbnM7XG5cbiAgLy8gU2V0IGdsb2JhbCB0aW1lb3V0XG4gIGplc3Quc2V0VGltZW91dCh0aW1lb3V0KTtcblxuICBiZWZvcmVBbGwoKCkgPT4ge1xuICAgIC8vIFNldHVwIGFsbCBtb2Nrc1xuICAgIGlmIChpbmNsdWRlQVBJKSB7XG4gICAgICBzdGFuZGFyZE1vY2tzLnNldHVwQWxsKCk7XG4gICAgfVxuICAgIFxuICAgIGlmIChpbmNsdWRlU3RvcmFnZSkge1xuICAgICAgc3RhbmRhcmRNb2Nrcy5maWxlU3lzdGVtTW9ja3Muc2V0dXBTdG9yYWdlTW9ja3MoKTtcbiAgICB9XG5cbiAgICAvLyBTZXR1cCBNU1cgaWYgbmVlZGVkXG4gICAgaWYgKGluY2x1ZGVNU1cpIHtcbiAgICAgIC8vIE1TVyBzZXR1cCB3aWxsIGJlIGhhbmRsZWQgYnkgdGhlIE1TVyBzZXR1cCBmaWxlXG4gICAgICBjb25zb2xlLmxvZygnTVNXIHNldHVwIGhhbmRsZWQgYnkgc2V0dXAgZmlsZScpO1xuICAgIH1cbiAgfSk7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgLy8gUmVzZXQgYWxsIG1vY2tzIGJlZm9yZSBlYWNoIHRlc3RcbiAgICBpZiAocmVzZXRNb2Nrcykge1xuICAgICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgICBzdGFuZGFyZE1vY2tzLnJlc2V0QWxsKCk7XG4gICAgfVxuXG4gICAgLy8gQ2xlYW51cCBSZWFjdCBUZXN0aW5nIExpYnJhcnlcbiAgICBjbGVhbnVwKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgLy8gQWRkaXRpb25hbCBjbGVhbnVwIGlmIG5lZWRlZFxuICAgIGplc3QuY2xlYXJBbGxUaW1lcnMoKTtcbiAgfSk7XG5cbiAgYWZ0ZXJBbGwoKCkgPT4ge1xuICAgIC8vIEdsb2JhbCBjbGVhbnVwXG4gICAgc3RhbmRhcmRNb2Nrcy5yZXNldEFsbCgpO1xuICB9KTtcbn07XG5cbi8qKlxuICogQ29tcG9uZW50LXNwZWNpZmljIHRlc3Qgc2V0dXBcbiAqL1xuZXhwb3J0IGNvbnN0IHNldHVwQ29tcG9uZW50VGVzdEVudmlyb25tZW50ID0gKGNvbXBvbmVudE5hbWU6IHN0cmluZykgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAvLyBDb21wb25lbnQtc3BlY2lmaWMgc2V0dXBcbiAgICBjb25zb2xlLmxvZyhgU2V0dGluZyB1cCB0ZXN0IGVudmlyb25tZW50IGZvciAke2NvbXBvbmVudE5hbWV9YCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgLy8gQ29tcG9uZW50LXNwZWNpZmljIGNsZWFudXBcbiAgICBjbGVhbnVwKCk7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBBUEkgdGVzdCBlbnZpcm9ubWVudCBzZXR1cFxuICovXG5leHBvcnQgY29uc3Qgc2V0dXBBUElUZXN0RW52aXJvbm1lbnQgPSAoKSA9PiB7XG4gIGNvbnN0IHsgYXBpTW9ja3MgfSA9IHN0YW5kYXJkTW9ja3M7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgLy8gUmVzZXQgQVBJIG1vY2tzXG4gICAgYXBpTW9ja3MucmVzZXQoKTtcbiAgICBcbiAgICAvLyBTZXR1cCBkZWZhdWx0IHN1Y2Nlc3NmdWwgcmVzcG9uc2VzXG4gICAgYXBpTW9ja3Muc2V0dXBNb2NrUmVzcG9uc2VzKHtcbiAgICAgICdQT1NUOi9iYWNrZW5kL2FwaS91cGxvYWQvJzoge1xuICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7IGlkOiAxMjMsIHN0YXR1czogJ3BlbmRpbmcnIH0pXG4gICAgICB9LFxuICAgICAgJ0dFVDovYmFja2VuZC9hcGkvYW5hbHlzaXMvMTIzLyc6IHtcbiAgICAgICAgb2s6IHRydWUsXG4gICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgIGlkOiAxMjMsXG4gICAgICAgICAgc3RhdHVzOiAnY29tcGxldGVkJyxcbiAgICAgICAgICBvcmlnaW5hbF90ZXh0OiAnTW9jayBhbmFseXNpcyByZXN1bHQnXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgbW9ja0ZldGNoOiBhcGlNb2Nrcy5tb2NrRmV0Y2gsXG4gICAgc2V0dXBNb2NrUmVzcG9uc2VzOiBhcGlNb2Nrcy5zZXR1cE1vY2tSZXNwb25zZXMsXG4gICAgbW9ja05ldHdvcmtFcnJvcjogYXBpTW9ja3MubW9ja05ldHdvcmtFcnJvcixcbiAgICBtb2NrVGltZW91dDogYXBpTW9ja3MubW9ja1RpbWVvdXRcbiAgfTtcbn07XG5cbi8qKlxuICogRmlsZSB1cGxvYWQgdGVzdCBlbnZpcm9ubWVudCBzZXR1cFxuICovXG5leHBvcnQgY29uc3Qgc2V0dXBGaWxlVXBsb2FkVGVzdEVudmlyb25tZW50ID0gKCkgPT4ge1xuICBjb25zdCB7IGZpbGVTeXN0ZW1Nb2NrcyB9ID0gc3RhbmRhcmRNb2NrcztcbiAgY29uc3QgeyBjcmVhdGVGaWxlVXBsb2FkVGVzdCB9ID0gdGVzdEZhY3RvcmllcztcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAvLyBTZXR1cCBmaWxlIHN5c3RlbSBtb2Nrc1xuICAgIGZpbGVTeXN0ZW1Nb2Nrcy5zZXR1cFN0b3JhZ2VNb2NrcygpO1xuICAgIFxuICAgIC8vIFJlc2V0IGZpbGUgc3lzdGVtIG1vY2tzXG4gICAgZmlsZVN5c3RlbU1vY2tzLnJlc2V0KCk7XG4gIH0pO1xuXG4gIGNvbnN0IGNyZWF0ZVRlc3RGaWxlID0gKG9wdGlvbnMgPSB7fSkgPT4ge1xuICAgIHJldHVybiBjcmVhdGVGaWxlVXBsb2FkVGVzdChvcHRpb25zKTtcbiAgfTtcblxuICBjb25zdCBjcmVhdGVNdWx0aXBsZVRlc3RGaWxlcyA9IChjb3VudDogbnVtYmVyLCBvcHRpb25zID0ge30pID0+IHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY291bnQgfSwgKF8sIGluZGV4KSA9PiBcbiAgICAgIGNyZWF0ZUZpbGVVcGxvYWRUZXN0KHsgXG4gICAgICAgIGZpbGVOYW1lOiBgdGVzdCR7aW5kZXggKyAxfS5wZGZgLFxuICAgICAgICAuLi5vcHRpb25zIFxuICAgICAgfSlcbiAgICApO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgY3JlYXRlVGVzdEZpbGUsXG4gICAgY3JlYXRlTXVsdGlwbGVUZXN0RmlsZXMsXG4gICAgbW9ja0xvY2FsU3RvcmFnZTogZmlsZVN5c3RlbU1vY2tzLm1vY2tMb2NhbFN0b3JhZ2UsXG4gICAgbW9ja1Nlc3Npb25TdG9yYWdlOiBmaWxlU3lzdGVtTW9ja3MubW9ja1Nlc3Npb25TdG9yYWdlLFxuICAgIG1vY2tGaWxlUmVhZGVyOiBmaWxlU3lzdGVtTW9ja3MubW9ja0ZpbGVSZWFkZXJcbiAgfTtcbn07XG5cbi8qKlxuICogTmF2aWdhdGlvbiB0ZXN0IGVudmlyb25tZW50IHNldHVwXG4gKi9cbmV4cG9ydCBjb25zdCBzZXR1cE5hdmlnYXRpb25UZXN0RW52aXJvbm1lbnQgPSAoKSA9PiB7XG4gIGNvbnN0IHsgbmF2aWdhdGlvbk1vY2tzIH0gPSBzdGFuZGFyZE1vY2tzO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIC8vIFJlc2V0IG5hdmlnYXRpb24gbW9ja3NcbiAgICBuYXZpZ2F0aW9uTW9ja3MucmVzZXQoKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBtb2NrUm91dGVyOiBuYXZpZ2F0aW9uTW9ja3MubW9ja1JvdXRlcixcbiAgICBtb2NrVXNlUm91dGVyOiBuYXZpZ2F0aW9uTW9ja3MubW9ja1VzZVJvdXRlcixcbiAgICBtb2NrVXNlUGF0aG5hbWU6IG5hdmlnYXRpb25Nb2Nrcy5tb2NrVXNlUGF0aG5hbWUsXG4gICAgbW9ja1VzZVNlYXJjaFBhcmFtczogbmF2aWdhdGlvbk1vY2tzLm1vY2tVc2VTZWFyY2hQYXJhbXNcbiAgfTtcbn07XG5cbi8qKlxuICogRW52aXJvbm1lbnQgdmFyaWFibGUgdGVzdCBzZXR1cFxuICovXG5leHBvcnQgY29uc3Qgc2V0dXBFbnZpcm9ubWVudFRlc3QgPSAoZW52OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge30pID0+IHtcbiAgY29uc3QgeyBlbnZpcm9ubWVudE1vY2tzIH0gPSBzdGFuZGFyZE1vY2tzO1xuICBjb25zdCBvcmlnaW5hbEVudiA9IHByb2Nlc3MuZW52O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIC8vIFNldCB0ZXN0IGVudmlyb25tZW50XG4gICAgZW52aXJvbm1lbnRNb2Nrcy5tb2NrRW52aXJvbm1lbnQoe1xuICAgICAgTk9ERV9FTlY6ICd0ZXN0JyxcbiAgICAgIE5FWFRfUFVCTElDX1RFU1RfTU9ERTogJ3RydWUnLFxuICAgICAgLi4uZW52XG4gICAgfSk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgLy8gUmVzZXQgZW52aXJvbm1lbnRcbiAgICBlbnZpcm9ubWVudE1vY2tzLnJlc2V0RW52aXJvbm1lbnQoKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBzZXRFbnY6IGVudmlyb25tZW50TW9ja3MubW9ja0Vudmlyb25tZW50LFxuICAgIHJlc2V0RW52OiBlbnZpcm9ubWVudE1vY2tzLnJlc2V0RW52aXJvbm1lbnRcbiAgfTtcbn07XG5cbi8qKlxuICogQ29tcHJlaGVuc2l2ZSB0ZXN0IHNldHVwIHRoYXQgY29tYmluZXMgYWxsIGVudmlyb25tZW50c1xuICovXG5leHBvcnQgY29uc3Qgc2V0dXBGdWxsVGVzdEVudmlyb25tZW50ID0gKG9wdGlvbnM6IFRlc3RFbnZpcm9ubWVudE9wdGlvbnMgPSB7fSkgPT4ge1xuICBjb25zdCBhcGlFbnYgPSBzZXR1cEFQSVRlc3RFbnZpcm9ubWVudCgpO1xuICBjb25zdCBmaWxlRW52ID0gc2V0dXBGaWxlVXBsb2FkVGVzdEVudmlyb25tZW50KCk7XG4gIGNvbnN0IG5hdkVudiA9IHNldHVwTmF2aWdhdGlvblRlc3RFbnZpcm9ubWVudCgpO1xuICBjb25zdCBlbnZUZXN0ID0gc2V0dXBFbnZpcm9ubWVudFRlc3QoKTtcblxuICAvLyBTZXR1cCBnbG9iYWwgZW52aXJvbm1lbnRcbiAgc2V0dXBHbG9iYWxUZXN0RW52aXJvbm1lbnQob3B0aW9ucyk7XG5cbiAgcmV0dXJuIHtcbiAgICBhcGk6IGFwaUVudixcbiAgICBmaWxlczogZmlsZUVudixcbiAgICBuYXZpZ2F0aW9uOiBuYXZFbnYsXG4gICAgZW52aXJvbm1lbnQ6IGVudlRlc3QsXG4gICAgbW9ja3M6IHN0YW5kYXJkTW9ja3MsXG4gICAgZmFjdG9yaWVzOiB0ZXN0RmFjdG9yaWVzXG4gIH07XG59O1xuXG4vKipcbiAqIFRlc3QgY2xlYW51cCB1dGlsaXRpZXNcbiAqL1xuZXhwb3J0IGNvbnN0IGNyZWF0ZVRlc3RDbGVhbnVwID0gKCkgPT4ge1xuICBjb25zdCBjbGVhbnVwRnVuY3Rpb25zOiAoKCkgPT4gdm9pZClbXSA9IFtdO1xuXG4gIGNvbnN0IGFkZENsZWFudXAgPSAoZm46ICgpID0+IHZvaWQpID0+IHtcbiAgICBjbGVhbnVwRnVuY3Rpb25zLnB1c2goZm4pO1xuICB9O1xuXG4gIGNvbnN0IHJ1bkNsZWFudXAgPSAoKSA9PiB7XG4gICAgY2xlYW51cEZ1bmN0aW9ucy5mb3JFYWNoKGZuID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZuKCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0NsZWFudXAgZnVuY3Rpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBjbGVhbnVwRnVuY3Rpb25zLmxlbmd0aCA9IDA7XG4gIH07XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBydW5DbGVhbnVwKCk7XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgYWRkQ2xlYW51cCxcbiAgICBydW5DbGVhbnVwXG4gIH07XG59O1xuXG4vKipcbiAqIFBlcmZvcm1hbmNlIHRlc3Qgc2V0dXBcbiAqL1xuZXhwb3J0IGNvbnN0IHNldHVwUGVyZm9ybWFuY2VUZXN0ID0gKCkgPT4ge1xuICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICBjb25zdCBtZWFzdXJlbWVudHM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcblxuICBjb25zdCBzdGFydE1lYXN1cmVtZW50ID0gKG5hbWU6IHN0cmluZykgPT4ge1xuICAgIG1lYXN1cmVtZW50c1tuYW1lXSA9IERhdGUubm93KCk7XG4gIH07XG5cbiAgY29uc3QgZW5kTWVhc3VyZW1lbnQgPSAobmFtZTogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gbWVhc3VyZW1lbnRzW25hbWVdO1xuICAgIGNvbnNvbGUubG9nKGBQZXJmb3JtYW5jZTogJHtuYW1lfSB0b29rICR7ZHVyYXRpb259bXNgKTtcbiAgICByZXR1cm4gZHVyYXRpb247XG4gIH07XG5cbiAgY29uc3QgZ2V0VG90YWxUaW1lID0gKCkgPT4gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICByZXR1cm4ge1xuICAgIHN0YXJ0TWVhc3VyZW1lbnQsXG4gICAgZW5kTWVhc3VyZW1lbnQsXG4gICAgZ2V0VG90YWxUaW1lXG4gIH07XG59O1xuXG4iXSwibmFtZXMiOlsiY3JlYXRlVGVzdENsZWFudXAiLCJzZXR1cEFQSVRlc3RFbnZpcm9ubWVudCIsInNldHVwQ29tcG9uZW50VGVzdEVudmlyb25tZW50Iiwic2V0dXBFbnZpcm9ubWVudFRlc3QiLCJzZXR1cEZpbGVVcGxvYWRUZXN0RW52aXJvbm1lbnQiLCJzZXR1cEZ1bGxUZXN0RW52aXJvbm1lbnQiLCJzZXR1cEdsb2JhbFRlc3RFbnZpcm9ubWVudCIsInNldHVwTmF2aWdhdGlvblRlc3RFbnZpcm9ubWVudCIsInNldHVwUGVyZm9ybWFuY2VUZXN0Iiwib3B0aW9ucyIsInRpbWVvdXQiLCJpbmNsdWRlTVNXIiwiaW5jbHVkZVN0b3JhZ2UiLCJpbmNsdWRlTmF2aWdhdGlvbiIsImluY2x1ZGVBUEkiLCJyZXNldE1vY2tzIiwiamVzdCIsInNldFRpbWVvdXQiLCJiZWZvcmVBbGwiLCJzdGFuZGFyZE1vY2tzIiwic2V0dXBBbGwiLCJmaWxlU3lzdGVtTW9ja3MiLCJzZXR1cFN0b3JhZ2VNb2NrcyIsImNvbnNvbGUiLCJsb2ciLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsInJlc2V0QWxsIiwiY2xlYW51cCIsImFmdGVyRWFjaCIsImNsZWFyQWxsVGltZXJzIiwiYWZ0ZXJBbGwiLCJjb21wb25lbnROYW1lIiwiYXBpTW9ja3MiLCJyZXNldCIsInNldHVwTW9ja1Jlc3BvbnNlcyIsIm9rIiwic3RhdHVzIiwianNvbiIsImlkIiwib3JpZ2luYWxfdGV4dCIsIm1vY2tGZXRjaCIsIm1vY2tOZXR3b3JrRXJyb3IiLCJtb2NrVGltZW91dCIsImNyZWF0ZUZpbGVVcGxvYWRUZXN0IiwidGVzdEZhY3RvcmllcyIsImNyZWF0ZVRlc3RGaWxlIiwiY3JlYXRlTXVsdGlwbGVUZXN0RmlsZXMiLCJjb3VudCIsIkFycmF5IiwiZnJvbSIsImxlbmd0aCIsIl8iLCJpbmRleCIsImZpbGVOYW1lIiwibW9ja0xvY2FsU3RvcmFnZSIsIm1vY2tTZXNzaW9uU3RvcmFnZSIsIm1vY2tGaWxlUmVhZGVyIiwibmF2aWdhdGlvbk1vY2tzIiwibW9ja1JvdXRlciIsIm1vY2tVc2VSb3V0ZXIiLCJtb2NrVXNlUGF0aG5hbWUiLCJtb2NrVXNlU2VhcmNoUGFyYW1zIiwiZW52IiwiZW52aXJvbm1lbnRNb2NrcyIsIm9yaWdpbmFsRW52IiwicHJvY2VzcyIsIm1vY2tFbnZpcm9ubWVudCIsIk5PREVfRU5WIiwiTkVYVF9QVUJMSUNfVEVTVF9NT0RFIiwicmVzZXRFbnZpcm9ubWVudCIsInNldEVudiIsInJlc2V0RW52IiwiYXBpRW52IiwiZmlsZUVudiIsIm5hdkVudiIsImVudlRlc3QiLCJhcGkiLCJmaWxlcyIsIm5hdmlnYXRpb24iLCJlbnZpcm9ubWVudCIsIm1vY2tzIiwiZmFjdG9yaWVzIiwiY2xlYW51cEZ1bmN0aW9ucyIsImFkZENsZWFudXAiLCJmbiIsInB1c2giLCJydW5DbGVhbnVwIiwiZm9yRWFjaCIsImVycm9yIiwid2FybiIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJtZWFzdXJlbWVudHMiLCJzdGFydE1lYXN1cmVtZW50IiwibmFtZSIsImVuZE1lYXN1cmVtZW50IiwiZHVyYXRpb24iLCJnZXRUb3RhbFRpbWUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0lBeU9hQSxpQkFBaUI7ZUFBakJBOztJQTlJQUMsdUJBQXVCO2VBQXZCQTs7SUFmQUMsNkJBQTZCO2VBQTdCQTs7SUE0R0FDLG9CQUFvQjtlQUFwQkE7O0lBeERBQyw4QkFBOEI7ZUFBOUJBOztJQW1GQUMsd0JBQXdCO2VBQXhCQTs7SUE5TEFDLDBCQUEwQjtlQUExQkE7O0lBZ0pBQyw4QkFBOEI7ZUFBOUJBOztJQW1HQUMsb0JBQW9CO2VBQXBCQTs7O3lCQXhROEM7dUJBQ25DO3VCQUNNOzJCQUNBO0FBa0J2QixNQUFNRiw2QkFBNkIsQ0FBQ0csVUFBa0MsQ0FBQyxDQUFDO0lBQzdFLE1BQU0sRUFDSkMsVUFBVSxLQUFLLEVBQ2ZDLGFBQWEsSUFBSSxFQUNqQkMsaUJBQWlCLElBQUksRUFDckJDLG9CQUFvQixJQUFJLEVBQ3hCQyxhQUFhLElBQUksRUFDakJDLGFBQWEsSUFBSSxFQUNsQixHQUFHTjtJQUVKLHFCQUFxQjtJQUNyQk8sS0FBS0MsVUFBVSxDQUFDUDtJQUVoQlEsSUFBQUEsa0JBQVMsRUFBQztRQUNSLGtCQUFrQjtRQUNsQixJQUFJSixZQUFZO1lBQ2RLLG9CQUFhLENBQUNDLFFBQVE7UUFDeEI7UUFFQSxJQUFJUixnQkFBZ0I7WUFDbEJPLG9CQUFhLENBQUNFLGVBQWUsQ0FBQ0MsaUJBQWlCO1FBQ2pEO1FBRUEsc0JBQXNCO1FBQ3RCLElBQUlYLFlBQVk7WUFDZCxrREFBa0Q7WUFDbERZLFFBQVFDLEdBQUcsQ0FBQztRQUNkO0lBQ0Y7SUFFQUMsSUFBQUEsbUJBQVUsRUFBQztRQUNULG1DQUFtQztRQUNuQyxJQUFJVixZQUFZO1lBQ2RDLEtBQUtVLGFBQWE7WUFDbEJQLG9CQUFhLENBQUNRLFFB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