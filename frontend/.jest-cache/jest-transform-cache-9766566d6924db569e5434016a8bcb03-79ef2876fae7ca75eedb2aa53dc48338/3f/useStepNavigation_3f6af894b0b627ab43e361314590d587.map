{"version":3,"sources":["/Users/jacobhornsvennevik/Documents/GitHub/maRepo_root/frontend/src/features/projects/hooks/useStepNavigation.ts"],"sourcesContent":["'use client';\n\nimport { useState } from \"react\";\nimport { SETUP_STEPS } from \"../services/steps\";\nimport { ProjectSetup } from \"../types\";\n\nexport const useStepNavigation = (\n  setup: ProjectSetup,\n  onBack: () => void,\n  setShowSummary: (show: boolean) => void,\n  extractedData?: any | null, // Add extractedData parameter\n) => {\n  const [currentStepIndex, setCurrentStepIndex] = useState(0);\n\n  const shouldShowStep = (stepId: string) => {\n    // Skip extraction results step if no data was extracted\n    if (stepId === \"extractionResults\" && !extractedData) {\n      return false;\n    }\n    return true;\n  };\n\n  const handleNext = () => {\n    // Find next step that should be shown\n    let nextStep = currentStepIndex + 1;\n\n    // Skip steps that shouldn't be shown\n    while (\n      nextStep < SETUP_STEPS.length &&\n      !shouldShowStep(SETUP_STEPS[nextStep].id)\n    ) {\n      nextStep++;\n    }\n\n    if (nextStep < SETUP_STEPS.length) {\n      setCurrentStepIndex(nextStep);\n    } else if (currentStepIndex === SETUP_STEPS.length - 1) {\n      // Only call setShowSummary when trying to go beyond the last step\n      // and we're already at the last step\n      setShowSummary(true);\n    }\n  };\n\n  const handleBack = () => {\n    // Find previous step that should be shown\n    let prevStep = currentStepIndex - 1;\n\n    // Skip steps that shouldn't be shown\n    while (prevStep >= 0 && !shouldShowStep(SETUP_STEPS[prevStep].id)) {\n      prevStep--;\n    }\n\n    if (prevStep >= 0) {\n      setCurrentStepIndex(prevStep);\n    } else {\n      onBack();\n    }\n  };\n\n  const handlePrevious = handleBack; // Alias for tests\n\n  // Functions for component use (these are called as functions in the UI)\n  const getCurrentStepIndex = () => {\n    let actualStep = 0;\n    for (let i = 0; i <= currentStepIndex; i++) {\n      if (shouldShowStep(SETUP_STEPS[i].id)) {\n        actualStep++;\n      }\n    }\n    return actualStep;\n  };\n\n  const getTotalSteps = () => {\n    return SETUP_STEPS.filter((step) => shouldShowStep(step.id)).length;\n  };\n\n  const totalSteps = getTotalSteps();\n  const currentStepNumber = getCurrentStepIndex();\n  const progress =\n    totalSteps > 1 ? ((currentStepNumber - 1) / (totalSteps - 1)) * 100 : 0;\n\n  const currentStep = SETUP_STEPS[currentStepIndex]; // Return step object\n  const isFirstStep = currentStepIndex === 0;\n  const isLastStep = currentStepIndex === SETUP_STEPS.length - 1;\n\n  return {\n    currentStepIndex, // Return the actual step index for tests (0-based)\n    currentStep, // Return step object for tests\n    setCurrentStep: setCurrentStepIndex,\n    handleNext,\n    handleBack,\n    handlePrevious,\n    shouldShowStep,\n    getCurrentStepIndex, // Return function for component use (1-based display)\n    getTotalSteps, // Return function for component use\n    progress,\n    currentStepData: currentStep, // Keep for backward compatibility\n    isFirstStep,\n    isLastStep,\n  };\n};\n"],"names":["useStepNavigation","setup","onBack","setShowSummary","extractedData","currentStepIndex","setCurrentStepIndex","useState","shouldShowStep","stepId","handleNext","nextStep","SETUP_STEPS","length","id","handleBack","prevStep","handlePrevious","getCurrentStepIndex","actualStep","i","getTotalSteps","filter","step","totalSteps","currentStepNumber","progress","currentStep","isFirstStep","isLastStep","setCurrentStep","currentStepData"],"mappings":"AAAA;;;;;+BAMaA;;;eAAAA;;;uBAJY;uBACG;AAGrB,MAAMA,oBAAoB,CAC/BC,OACAC,QACAC,gBACAC;IAEA,MAAM,CAACC,kBAAkBC,oBAAoB,GAAGC,IAAAA,eAAQ,EAAC;IAEzD,MAAMC,iBAAiB,CAACC;QACtB,wDAAwD;QACxD,IAAIA,WAAW,uBAAuB,CAACL,eAAe;YACpD,OAAO;QACT;QACA,OAAO;IACT;IAEA,MAAMM,aAAa;QACjB,sCAAsC;QACtC,IAAIC,WAAWN,mBAAmB;QAElC,qCAAqC;QACrC,MACEM,WAAWC,kBAAW,CAACC,MAAM,IAC7B,CAACL,eAAeI,kBAAW,CAACD,SAAS,CAACG,EAAE,EACxC;YACAH;QACF;QAEA,IAAIA,WAAWC,kBAAW,CAACC,MAAM,EAAE;YACjCP,oBAAoBK;QACtB,OAAO,IAAIN,qBAAqBO,kBAAW,CAACC,MAAM,GAAG,GAAG;YACtD,kEAAkE;YAClE,qCAAqC;YACrCV,eAAe;QACjB;IACF;IAEA,MAAMY,aAAa;QACjB,0CAA0C;QAC1C,IAAIC,WAAWX,mBAAmB;QAElC,qCAAqC;QACrC,MAAOW,YAAY,KAAK,CAACR,eAAeI,kBAAW,CAACI,SAAS,CAACF,EAAE,EAAG;YACjEE;QACF;QAEA,IAAIA,YAAY,GAAG;YACjBV,oBAAoBU;QACtB,OAAO;YACLd;QACF;IACF;IAEA,MAAMe,iBAAiBF,YAAY,kBAAkB;IAErD,wEAAwE;IACxE,MAAMG,sBAAsB;QAC1B,IAAIC,aAAa;QACjB,IAAK,IAAIC,IAAI,GAAGA,KAAKf,kBAAkBe,IAAK;YAC1C,IAAIZ,eAAeI,kBAAW,CAACQ,EAAE,CAACN,EAAE,GAAG;gBACrCK;YACF;QACF;QACA,OAAOA;IACT;IAEA,MAAME,gBAAgB;QACpB,OAAOT,kBAAW,CAACU,MAAM,CAAC,CAACC,OAASf,eAAee,KAAKT,EAAE,GAAGD,MAAM;IACrE;IAEA,MAAMW,aAAaH;IACnB,MAAMI,oBAAoBP;IAC1B,MAAMQ,WACJF,aAAa,IAAI,AAAEC,CAAAA,oBAAoB,CAAA,IAAMD,CAAAA,aAAa,CAAA,IAAM,MAAM;IAExE,MAAMG,cAAcf,kBAAW,CAACP,iBAAiB,EAAE,qBAAqB;IACxE,MAAMuB,cAAcvB,qBAAqB;IACzC,MAAMwB,aAAaxB,qBAAqBO,kBAAW,CAACC,MAAM,GAAG;IAE7D,OAAO;QACLR;QACAsB;QACAG,gBAAgBxB;QAChBI;QACAK;QACAE;QACAT;QACAU;QACAG;QACAK;QACAK,iBAAiBJ;QACjBC;QACAC;IACF;AACF"}