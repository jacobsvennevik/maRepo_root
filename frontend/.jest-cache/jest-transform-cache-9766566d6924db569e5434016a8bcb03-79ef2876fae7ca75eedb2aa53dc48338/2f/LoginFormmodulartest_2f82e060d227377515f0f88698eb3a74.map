{"version":3,"sources":["/Users/jacobhornsvennevik/Documents/GitHub/maRepo_root/frontend/src/app/(auth)/components/__tests__/LoginForm-modular.test.tsx"],"sourcesContent":["/**\n * LoginForm Modular Tests - Simplified Version\n * \n * Working modular test suite using simplified patterns for\n * authentication functionality testing.\n */\n\nimport React from 'react';\nimport { screen, fireEvent, waitFor, act, render } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport '@testing-library/jest-dom';\n\nimport { LoginForm } from '../LoginForm';\nimport { standardMocks } from '../../../../test-utils/mocks';\n\n// Simple render function for testing\nconst renderWithProviders = (component: React.ReactElement) => {\n  return render(component);\n};\n\n// Mock authentication services\njest.mock('@/lib/axios-auth', () => ({\n  axiosAuth: { post: jest.fn() },\n}));\n\njest.mock('@/lib/axios-api', () => ({\n  axiosApi: { get: jest.fn(), post: jest.fn(), patch: jest.fn(), delete: jest.fn() },\n}));\n\njest.mock('next/navigation', () => ({\n  useRouter: () => ({\n    push: jest.fn(),\n    replace: jest.fn(),\n    back: jest.fn(),\n    forward: jest.fn(),\n    refresh: jest.fn(),\n  }),\n}));\n\ndescribe('LoginForm', () => {\n  const mockAxiosAuth = {\n    post: jest.fn(),\n  };\n  \n  const mockAxiosApi = {\n    get: jest.fn(),\n    post: jest.fn(),\n    patch: jest.fn(),\n    delete: jest.fn(),\n  };\n  \n  const mockRouter = {\n    push: jest.fn(),\n    replace: jest.fn(),\n    back: jest.fn(),\n    forward: jest.fn(),\n    refresh: jest.fn(),\n  };\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  // ============================================================================\n  // Rendering Tests\n  // ============================================================================\n\n  describe('Rendering', () => {\n    it('renders login form with all required elements', () => {\n      renderWithProviders(<LoginForm />);\n      \n      expect(screen.getByTestId('login-form')).toBeInTheDocument();\n      expect(screen.getByLabelText(/email/i)).toBeInTheDocument();\n      expect(screen.getByLabelText(/password/i)).toBeInTheDocument();\n      expect(screen.getByRole('button', { name: /^sign in$/i })).toBeInTheDocument();\n    });\n\n    it('renders with proper accessibility attributes', () => {\n      renderWithProviders(<LoginForm />);\n      \n      const form = screen.getByTestId('login-form');\n      const emailInput = screen.getByLabelText(/email/i);\n      const passwordInput = screen.getByLabelText(/password/i);\n      \n      expect(form).toBeInTheDocument();\n      expect(emailInput).toHaveAttribute('type', 'email');\n      expect(passwordInput).toHaveAttribute('type', 'password');\n    });\n  });\n\n  // ============================================================================\n  // Authentication Flow Tests\n  // ============================================================================\n\n  describe('Authentication Flow', () => {\n    it('handles successful login', async () => {\n      const user = userEvent.setup();\n      \n      // Mock successful responses\n      mockAxiosAuth.post.mockResolvedValueOnce({\n        data: {\n          access: 'mock-access-token',\n          refresh: 'mock-refresh-token',\n        },\n      });\n      \n      mockAxiosApi.get.mockResolvedValueOnce({\n        data: { id: 1, email: 'test@example.com' }\n      });\n\n      renderWithProviders(<LoginForm />);\n\n      // Fill and submit form\n      await act(async () => {\n        await user.type(screen.getByLabelText(/email/i), 'test@example.com');\n        await user.type(screen.getByLabelText(/password/i), 'password123');\n        await user.click(screen.getByRole('button', { name: /^sign in$/i }));\n      });\n\n      // Verify authentication flow\n      await waitFor(() => {\n        expect(mockAxiosAuth.post).toHaveBeenCalledWith('/token/', {\n          email: 'test@example.com',\n          password: 'password123',\n        });\n        expect(mockAxiosApi.get).toHaveBeenCalledWith('users/me/');\n        expect(mockRouter.push).toHaveBeenCalledWith('/dashboard');\n      }, { timeout: 5000 });\n    });\n\n    it('handles login error', async () => {\n      const user = userEvent.setup();\n      \n      // Mock failed login\n      mockAxiosAuth.post.mockRejectedValueOnce({\n        response: {\n          data: {\n            detail: 'Invalid credentials'\n          }\n        }\n      });\n\n      renderWithProviders(<LoginForm />);\n\n      // Fill and submit form\n      await act(async () => {\n        await user.type(screen.getByLabelText(/email/i), 'test@example.com');\n        await user.type(screen.getByLabelText(/password/i), 'wrongpassword');\n        await user.click(screen.getByRole('button', { name: /^sign in$/i }));\n      });\n\n      // Wait for error message\n      await waitFor(() => {\n        expect(screen.getByText(/invalid credentials/i)).toBeInTheDocument();\n      }, { timeout: 3000 });\n    });\n\n    it('validates required fields', async () => {\n      const user = userEvent.setup();\n      \n      renderWithProviders(<LoginForm />);\n\n      // Try to submit without filling fields\n      await act(async () => {\n        await user.click(screen.getByRole('button', { name: /^sign in$/i }));\n      });\n\n      // Check for validation messages\n      await waitFor(() => {\n        expect(screen.getByText(/please enter a valid email address/i)).toBeInTheDocument();\n        expect(screen.getByText(/password must be at least 8 characters/i)).toBeInTheDocument();\n      }, { timeout: 3000 });\n    });\n  });\n\n  // ============================================================================\n  // Data-Driven Tests\n  // ============================================================================\n\n  describe('Data-Driven Authentication', () => {\n    const validCredentials = [\n      { email: 'test@example.com', password: 'password123' },\n      { email: 'user@domain.org', password: 'securepass456' },\n      { email: 'admin@company.com', password: 'adminpass789' }\n    ];\n\n    validCredentials.forEach((credentials, index) => {\n      it(`handles valid credentials ${index + 1}`, async () => {\n        const user = userEvent.setup();\n        \n        // Mock successful responses\n        mockAxiosAuth.post.mockResolvedValueOnce({\n          data: {\n            access: 'mock-access-token',\n            refresh: 'mock-refresh-token',\n          },\n        });\n        \n        mockAxiosApi.get.mockResolvedValueOnce({\n          data: { id: 1, email: credentials.email }\n        });\n\n        renderWithProviders(<LoginForm />);\n\n        // Fill and submit form\n        await act(async () => {\n          await user.type(screen.getByLabelText(/email/i), credentials.email);\n          await user.type(screen.getByLabelText(/password/i), credentials.password);\n          await user.click(screen.getByRole('button', { name: /^sign in$/i }));\n        });\n\n        // Verify authentication flow\n        await waitFor(() => {\n          expect(mockAxiosAuth.post).toHaveBeenCalledWith('/token/', {\n            email: credentials.email,\n            password: credentials.password,\n          });\n          expect(mockAxiosApi.get).toHaveBeenCalledWith('users/me/');\n          expect(mockRouter.push).toHaveBeenCalledWith('/dashboard');\n        }, { timeout: 5000 });\n      });\n    });\n  });\n\n  // ============================================================================\n  // Accessibility Tests\n  // ============================================================================\n\n  describe('Accessibility', () => {\n    it('has proper ARIA labels and roles', () => {\n      renderWithProviders(<LoginForm />);\n      \n      const form = screen.getByTestId('login-form');\n      const emailInput = screen.getByLabelText(/email/i);\n      const passwordInput = screen.getByLabelText(/password/i);\n      const submitButton = screen.getByRole('button', { name: /^sign in$/i });\n      \n      expect(form).toBeInTheDocument();\n      expect(emailInput).toHaveAttribute('type', 'email');\n      expect(passwordInput).toHaveAttribute('type', 'password');\n      expect(submitButton).toHaveAttribute('type', 'submit');\n    });\n\n    it('supports keyboard navigation', async () => {\n      const user = userEvent.setup();\n      \n      renderWithProviders(<LoginForm />);\n\n      // Tab through form elements\n      await user.tab();\n      expect(screen.getByLabelText(/email/i)).toHaveFocus();\n      \n      await user.tab();\n      expect(screen.getByLabelText(/password/i)).toHaveFocus();\n      \n      await user.tab();\n      expect(screen.getByRole('button', { name: /^sign in$/i })).toHaveFocus();\n    });\n  });\n\n  // ============================================================================\n  // Performance Tests\n  // ============================================================================\n\n  describe('Performance', () => {\n    it('renders within acceptable time', () => {\n      const startTime = performance.now();\n      renderWithProviders(<LoginForm />);\n      const endTime = performance.now();\n      \n      expect(endTime - startTime).toBeLessThan(100); // Should render in < 100ms\n    });\n\n    it('handles login efficiently', async () => {\n      const user = userEvent.setup();\n      \n      mockAxiosAuth.post.mockResolvedValueOnce({\n        data: { access: 'token', refresh: 'refresh' }\n      });\n      mockAxiosApi.get.mockResolvedValueOnce({\n        data: { id: 1, email: 'test@example.com' }\n      });\n\n      renderWithProviders(<LoginForm />);\n\n      const startTime = performance.now();\n      \n      await act(async () => {\n        await user.type(screen.getByLabelText(/email/i), 'test@example.com');\n        await user.type(screen.getByLabelText(/password/i), 'password123');\n        await user.click(screen.getByRole('button', { name: /^sign in$/i }));\n      });\n\n      await waitFor(() => {\n        expect(mockAxiosAuth.post).toHaveBeenCalled();\n      });\n\n      const endTime = performance.now();\n      expect(endTime - startTime).toBeLessThan(2000); // Should complete in < 2s\n    });\n  });\n});"],"names":["jest","mock","axiosAuth","post","fn","axiosApi","get","patch","delete","useRouter","push","replace","back","forward","refresh","renderWithProviders","component","render","describe","mockAxiosAuth","mockAxiosApi","mockRouter","beforeEach","clearAllMocks","it","LoginForm","expect","screen","getByTestId","toBeInTheDocument","getByLabelText","getByRole","name","form","emailInput","passwordInput","toHaveAttribute","user","userEvent","setup","mockResolvedValueOnce","data","access","id","email","act","type","click","waitFor","toHaveBeenCalledWith","password","timeout","mockRejectedValueOnce","response","detail","getByText","validCredentials","forEach","credentials","index","submitButton","tab","toHaveFocus","startTime","performance","now","endTime","toBeLessThan","toHaveBeenCalled"],"mappings":"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"}