8046e77cb8a8b28c635490fd96b89c46
/**
 * Enhanced Multi-Source Management Hook
 * 
 * Handles flashcards, files, and study materials selection
 * for wizard components. Extends the existing useFileManagement
 * pattern to support multiple source types.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    default: function() {
        return _default;
    },
    useMultiSourceManagement: function() {
        return useMultiSourceManagement;
    }
});
const _react = require("react");
const _axios = /*#__PURE__*/ _interop_require_wildcard(require("../../../lib/axios"));
const _projectId = require("../../../lib/projectId");
const _projectApi = require("../../../lib/projectApi");
const _uploadutils = require("../../../features/projects/services/upload-utils");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
// ============================================================================
// Default Values
// ============================================================================
const DEFAULT_SELECTED_SOURCES = {
    flashcards: {
        ids: [],
        groundOnly: false
    },
    files: {
        ids: [],
        groundOnly: false
    },
    studyMaterials: {
        ids: [],
        groundOnly: false
    }
};
const DEFAULT_SUPPORTED_TYPES = [
    'flashcards',
    'files',
    'studyMaterials'
];
const useMultiSourceManagement = ({ projectId, supportedTypes = DEFAULT_SUPPORTED_TYPES, onSourcesChange, autoLoad = true })=>{
    const [flashcards, setFlashcards] = (0, _react.useState)([]);
    const [files, setFiles] = (0, _react.useState)([]);
    const [studyMaterials, setStudyMaterials] = (0, _react.useState)([]);
    const [uploadedFiles, setUploadedFiles] = (0, _react.useState)([]);
    const [isLoadingFlashcards, setIsLoadingFlashcards] = (0, _react.useState)(false);
    const [isLoadingFiles, setIsLoadingFiles] = (0, _react.useState)(false);
    const [isLoadingStudyMaterials, setIsLoadingStudyMaterials] = (0, _react.useState)(false);
    const [isRefreshing, setIsRefreshing] = (0, _react.useState)(false);
    const [selectedSources, setSelectedSourcesState] = (0, _react.useState)(DEFAULT_SELECTED_SOURCES);
    const [searchTerm, setSearchTerm] = (0, _react.useState)('');
    const loadFlashcards = (0, _react.useCallback)(async ()=>{
        if (!supportedTypes.includes('flashcards')) return;
        if (isLoadingFlashcards) return;
        setIsLoadingFlashcards(true);
        try {
            const response = await (0, _projectApi.getProjectScoped)(`flashcard-sets/`, projectId);
            const raw = response?.data ?? response ?? [];
            const flashcardData = (Array.isArray(raw) ? raw : raw?.results || []).map((deck)=>({
                    id: deck.id,
                    title: deck.title,
                    description: deck.description,
                    flashcard_count: deck.flashcard_count || 0,
                    created_at: deck.created_at,
                    updated_at: deck.updated_at,
                    type: 'flashcard'
                }));
            setFlashcards(flashcardData);
        } catch (error) {
            console.error('Failed to load flashcards:', error);
            if ((0, _uploadutils.isTestMode)() && (error?.code === 'ERR_NETWORK' || !error?.response)) {
                setFlashcards([]);
            } else {
                setFlashcards([]);
            }
        } finally{
            setIsLoadingFlashcards(false);
        }
    }, [
        projectId,
        supportedTypes,
        isLoadingFlashcards
    ]);
    const loadFiles = (0, _react.useCallback)(async ()=>{
        if (!supportedTypes.includes('files')) return;
        if (isLoadingFiles) return;
        setIsLoadingFiles(true);
        try {
            // Project detail includes uploaded_files
            const res = await _axios.axiosApi.get(`projects/${projectId}/`);
            const project = res?.data || {};
            const uploaded = Array.isArray(project.uploaded_files) ? project.uploaded_files : [];
            const fileData = uploaded.map((file)=>({
                    id: file.id,
                    name: file.original_name || (file.file ? String(file.file).split('/').pop() : ''),
                    description: '',
                    size: file.file_size,
                    file_type: file.content_type,
                    created_at: file.uploaded_at,
                    type: 'file'
                }));
            setFiles(fileData);
        } catch (error) {
            console.error('Failed to load files:', error);
            if ((0, _uploadutils.isTestMode)() && (error?.code === 'ERR_NETWORK' || !error?.response)) {
                setFiles([]);
            } else {
                setFiles([]);
            }
        } finally{
            setIsLoadingFiles(false);
        }
    }, [
        projectId,
        supportedTypes,
        isLoadingFiles
    ]);
    const loadStudyMaterials = (0, _react.useCallback)(async ()=>{
        if (!supportedTypes.includes('studyMaterials')) return;
        if (isLoadingStudyMaterials) return;
        setIsLoadingStudyMaterials(true);
        try {
            // Study materials live under non-API prefix
            const pid = (0, _projectId.normalizeProjectId)(projectId);
            const res = await _axios.default.get(`/study_materials/study_materials/`, {
                params: {
                    project: pid
                }
            });
            const raw = res?.data ?? [];
            const list = Array.isArray(raw) ? raw : raw?.results || [];
            // Filter by project if backend ignores query param
            const filtered = list.filter((m)=>!m.project || String(m.project) === String(pid));
            const materialData = filtered.map((material)=>({
                    id: material.id,
                    title: material.title,
                    name: material.title,
                    description: material.description,
                    created_at: material.created_at,
                    updated_at: material.updated_at,
                    type: 'study_material'
                }));
            setStudyMaterials(materialData);
        } catch (error) {
            console.error('Failed to load study materials:', error);
            if ((0, _uploadutils.isTestMode)() && (error?.code === 'ERR_NETWORK' || !error?.response)) {
                setStudyMaterials([]);
            } else {
                setStudyMaterials([]);
            }
        } finally{
            setIsLoadingStudyMaterials(false);
        }
    }, [
        projectId,
        supportedTypes,
        isLoadingStudyMaterials
    ]);
    const handleFileUpload = (0, _react.useCallback)(async (files)=>{
        setUploadedFiles((prev)=>[
                ...prev,
                ...files
            ]);
        try {
            for (const file of files){
                const formData = new FormData();
                formData.append('file', file);
                const response = await _axios.axiosApi.post(`projects/${projectId}/upload_file/`, formData, {
                    headers: {
                        'Content-Type': 'multipart/form-data'
                    }
                });
                if (response.status === 200 || response.status === 201) {
                    console.log('✅ File uploaded successfully:', file.name);
                }
            }
            setTimeout(()=>{
                loadFiles();
            }, 1000);
        } catch (error) {
            console.error('❌ File upload failed:', error);
        }
    }, [
        projectId,
        loadFiles
    ]);
    const removeUploadedFile = (0, _react.useCallback)((index)=>{
        setUploadedFiles((prev)=>prev.filter((_, i)=>i !== index));
    }, []);
    const setSelectedSources = (0, _react.useCallback)((sources)=>{
        setSelectedSourcesState(sources);
        onSourcesChange?.(sources);
    }, [
        onSourcesChange
    ]);
    const clearSelection = (0, _react.useCallback)(()=>{
        setSelectedSources(DEFAULT_SELECTED_SOURCES);
        setUploadedFiles([]);
        setSearchTerm('');
    }, [
        setSelectedSources
    ]);
    const refreshSources = (0, _react.useCallback)(async ()=>{
        if (isRefreshing) return;
        setIsRefreshing(true);
        try {
            await Promise.all([
                loadFlashcards(),
                loadFiles(),
                loadStudyMaterials()
            ]);
        } finally{
            setIsRefreshing(false);
        }
    }, [
        isRefreshing,
        loadFlashcards,
        loadFiles,
        loadStudyMaterials
    ]);
    (0, _react.useEffect)(()=>{
        if (autoLoad && projectId) {
            refreshSources();
        }
    }, [
        autoLoad,
        projectId,
        refreshSources
    ]);
    const totalSelectedCount = selectedSources.flashcards.ids.length + selectedSources.files.ids.length + selectedSources.studyMaterials.ids.length + uploadedFiles.length;
    const hasMinimumSelection = totalSelectedCount >= 1;
    const isAnyLoading = isLoadingFlashcards || isLoadingFiles || isLoadingStudyMaterials;
    return {
        flashcards,
        files,
        studyMaterials,
        uploadedFiles,
        isLoadingFlashcards,
        isLoadingFiles,
        isLoadingStudyMaterials,
        selectedSources,
        searchTerm,
        setSelectedSources,
        setSearchTerm,
        handleFileUpload,
        removeUploadedFile,
        refreshSources,
        clearSelection,
        totalSelectedCount,
        hasMinimumSelection,
        isAnyLoading
    };
};
const _default = useMultiSourceManagement;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYWNvYmhvcm5zdmVubmV2aWsvRG9jdW1lbnRzL0dpdEh1Yi9tYVJlcG9fcm9vdC9mcm9udGVuZC9zcmMvY29tcG9uZW50cy93aXphcmQvc2hhcmVkL3VzZU11bHRpU291cmNlTWFuYWdlbWVudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEVuaGFuY2VkIE11bHRpLVNvdXJjZSBNYW5hZ2VtZW50IEhvb2tcbiAqIFxuICogSGFuZGxlcyBmbGFzaGNhcmRzLCBmaWxlcywgYW5kIHN0dWR5IG1hdGVyaWFscyBzZWxlY3Rpb25cbiAqIGZvciB3aXphcmQgY29tcG9uZW50cy4gRXh0ZW5kcyB0aGUgZXhpc3RpbmcgdXNlRmlsZU1hbmFnZW1lbnRcbiAqIHBhdHRlcm4gdG8gc3VwcG9ydCBtdWx0aXBsZSBzb3VyY2UgdHlwZXMuXG4gKi9cblxuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgYXhpb3NJbnN0YW5jZSwgeyBheGlvc0FwaSB9IGZyb20gJ0AvbGliL2F4aW9zJztcbmltcG9ydCB7IG5vcm1hbGl6ZVByb2plY3RJZCB9IGZyb20gJ0AvbGliL3Byb2plY3RJZCc7XG5pbXBvcnQgeyBnZXRQcm9qZWN0U2NvcGVkIH0gZnJvbSAnQC9saWIvcHJvamVjdEFwaSc7XG5pbXBvcnQgeyBpc1Rlc3RNb2RlIH0gZnJvbSAnQC9mZWF0dXJlcy9wcm9qZWN0cy9zZXJ2aWNlcy91cGxvYWQtdXRpbHMnO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBUeXBlcyBhbmQgSW50ZXJmYWNlc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIFNvdXJjZUl0ZW0ge1xuICBpZDogc3RyaW5nO1xuICBuYW1lPzogc3RyaW5nO1xuICB0aXRsZT86IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIHNpemU/OiBudW1iZXI7XG4gIGNyZWF0ZWRfYXQ/OiBzdHJpbmc7XG4gIHVwZGF0ZWRfYXQ/OiBzdHJpbmc7XG4gIGZpbGVfdHlwZT86IHN0cmluZztcbiAgZmxhc2hjYXJkX2NvdW50PzogbnVtYmVyO1xuICB0eXBlOiAnZmxhc2hjYXJkJyB8ICdmaWxlJyB8ICdzdHVkeV9tYXRlcmlhbCc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VsZWN0ZWRTb3VyY2VzIHtcbiAgZmxhc2hjYXJkczogeyBpZHM6IHN0cmluZ1tdOyBncm91bmRPbmx5OiBib29sZWFuIH07XG4gIGZpbGVzOiB7IGlkczogc3RyaW5nW107IGdyb3VuZE9ubHk6IGJvb2xlYW4gfTtcbiAgc3R1ZHlNYXRlcmlhbHM6IHsgaWRzOiBzdHJpbmdbXTsgZ3JvdW5kT25seTogYm9vbGVhbiB9O1xufVxuXG5pbnRlcmZhY2UgVXNlTXVsdGlTb3VyY2VNYW5hZ2VtZW50T3B0aW9ucyB7XG4gIHByb2plY3RJZDogc3RyaW5nO1xuICBzdXBwb3J0ZWRUeXBlcz86IEFycmF5PCdmbGFzaGNhcmRzJyB8ICdmaWxlcycgfCAnc3R1ZHlNYXRlcmlhbHMnPjtcbiAgb25Tb3VyY2VzQ2hhbmdlPzogKHNvdXJjZXM6IFNlbGVjdGVkU291cmNlcykgPT4gdm9pZDtcbiAgYXV0b0xvYWQ/OiBib29sZWFuO1xufVxuXG5pbnRlcmZhY2UgVXNlTXVsdGlTb3VyY2VNYW5hZ2VtZW50UmV0dXJuIHtcbiAgLy8gU291cmNlIGRhdGFcbiAgZmxhc2hjYXJkczogU291cmNlSXRlbVtdO1xuICBmaWxlczogU291cmNlSXRlbVtdO1xuICBzdHVkeU1hdGVyaWFsczogU291cmNlSXRlbVtdO1xuICBcbiAgLy8gVXBsb2FkIGhhbmRsaW5nXG4gIHVwbG9hZGVkRmlsZXM6IEZpbGVbXTtcbiAgXG4gIC8vIExvYWRpbmcgc3RhdGVzXG4gIGlzTG9hZGluZ0ZsYXNoY2FyZHM6IGJvb2xlYW47XG4gIGlzTG9hZGluZ0ZpbGVzOiBib29sZWFuO1xuICBpc0xvYWRpbmdTdHVkeU1hdGVyaWFsczogYm9vbGVhbjtcbiAgXG4gIC8vIFNlbGVjdGlvbiBzdGF0ZVxuICBzZWxlY3RlZFNvdXJjZXM6IFNlbGVjdGVkU291cmNlcztcbiAgXG4gIC8vIFNlYXJjaFxuICBzZWFyY2hUZXJtOiBzdHJpbmc7XG4gIFxuICAvLyBBY3Rpb25zXG4gIHNldFNlbGVjdGVkU291cmNlczogKHNvdXJjZXM6IFNlbGVjdGVkU291cmNlcykgPT4gdm9pZDtcbiAgc2V0U2VhcmNoVGVybTogKHRlcm06IHN0cmluZykgPT4gdm9pZDtcbiAgaGFuZGxlRmlsZVVwbG9hZDogKGZpbGVzOiBGaWxlW10pID0+IFByb21pc2U8dm9pZD47XG4gIHJlbW92ZVVwbG9hZGVkRmlsZTogKGluZGV4OiBudW1iZXIpID0+IHZvaWQ7XG4gIHJlZnJlc2hTb3VyY2VzOiAoKSA9PiBQcm9taXNlPHZvaWQ+O1xuICBjbGVhclNlbGVjdGlvbjogKCkgPT4gdm9pZDtcbiAgXG4gIC8vIENvbXB1dGVkIHZhbHVlc1xuICB0b3RhbFNlbGVjdGVkQ291bnQ6IG51bWJlcjtcbiAgaGFzTWluaW11bVNlbGVjdGlvbjogYm9vbGVhbjtcbiAgaXNBbnlMb2FkaW5nOiBib29sZWFuO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBEZWZhdWx0IFZhbHVlc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBERUZBVUxUX1NFTEVDVEVEX1NPVVJDRVM6IFNlbGVjdGVkU291cmNlcyA9IHtcbiAgZmxhc2hjYXJkczogeyBpZHM6IFtdLCBncm91bmRPbmx5OiBmYWxzZSB9LFxuICBmaWxlczogeyBpZHM6IFtdLCBncm91bmRPbmx5OiBmYWxzZSB9LFxuICBzdHVkeU1hdGVyaWFsczogeyBpZHM6IFtdLCBncm91bmRPbmx5OiBmYWxzZSB9LFxufTtcblxuY29uc3QgREVGQVVMVF9TVVBQT1JURURfVFlQRVM6IEFycmF5PCdmbGFzaGNhcmRzJyB8ICdmaWxlcycgfCAnc3R1ZHlNYXRlcmlhbHMnPiA9IFsnZmxhc2hjYXJkcycsICdmaWxlcycsICdzdHVkeU1hdGVyaWFscyddXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEhvb2sgSW1wbGVtZW50YXRpb25cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IHVzZU11bHRpU291cmNlTWFuYWdlbWVudCA9ICh7XG4gIHByb2plY3RJZCxcbiAgc3VwcG9ydGVkVHlwZXMgPSBERUZBVUxUX1NVUFBPUlRFRF9UWVBFUyxcbiAgb25Tb3VyY2VzQ2hhbmdlLFxuICBhdXRvTG9hZCA9IHRydWUsXG59OiBVc2VNdWx0aVNvdXJjZU1hbmFnZW1lbnRPcHRpb25zKTogVXNlTXVsdGlTb3VyY2VNYW5hZ2VtZW50UmV0dXJuID0+IHtcbiAgY29uc3QgW2ZsYXNoY2FyZHMsIHNldEZsYXNoY2FyZHNdID0gdXNlU3RhdGU8U291cmNlSXRlbVtdPihbXSk7XG4gIGNvbnN0IFtmaWxlcywgc2V0RmlsZXNdID0gdXNlU3RhdGU8U291cmNlSXRlbVtdPihbXSk7XG4gIGNvbnN0IFtzdHVkeU1hdGVyaWFscywgc2V0U3R1ZHlNYXRlcmlhbHNdID0gdXNlU3RhdGU8U291cmNlSXRlbVtdPihbXSk7XG4gIGNvbnN0IFt1cGxvYWRlZEZpbGVzLCBzZXRVcGxvYWRlZEZpbGVzXSA9IHVzZVN0YXRlPEZpbGVbXT4oW10pO1xuICBcbiAgY29uc3QgW2lzTG9hZGluZ0ZsYXNoY2FyZHMsIHNldElzTG9hZGluZ0ZsYXNoY2FyZHNdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbaXNMb2FkaW5nRmlsZXMsIHNldElzTG9hZGluZ0ZpbGVzXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2lzTG9hZGluZ1N0dWR5TWF0ZXJpYWxzLCBzZXRJc0xvYWRpbmdTdHVkeU1hdGVyaWFsc10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtpc1JlZnJlc2hpbmcsIHNldElzUmVmcmVzaGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIFxuICBjb25zdCBbc2VsZWN0ZWRTb3VyY2VzLCBzZXRTZWxlY3RlZFNvdXJjZXNTdGF0ZV0gPSB1c2VTdGF0ZTxTZWxlY3RlZFNvdXJjZXM+KERFRkFVTFRfU0VMRUNURURfU09VUkNFUyk7XG4gIGNvbnN0IFtzZWFyY2hUZXJtLCBzZXRTZWFyY2hUZXJtXSA9IHVzZVN0YXRlKCcnKTtcblxuICBjb25zdCBsb2FkRmxhc2hjYXJkcyA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcbiAgICBpZiAoIXN1cHBvcnRlZFR5cGVzLmluY2x1ZGVzKCdmbGFzaGNhcmRzJykpIHJldHVybjtcbiAgICBpZiAoaXNMb2FkaW5nRmxhc2hjYXJkcykgcmV0dXJuO1xuICAgIHNldElzTG9hZGluZ0ZsYXNoY2FyZHModHJ1ZSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlOiBhbnkgPSBhd2FpdCBnZXRQcm9qZWN0U2NvcGVkKGBmbGFzaGNhcmQtc2V0cy9gLCBwcm9qZWN0SWQpO1xuICAgICAgY29uc3QgcmF3ID0gcmVzcG9uc2U/LmRhdGEgPz8gcmVzcG9uc2UgPz8gW11cbiAgICAgIGNvbnN0IGZsYXNoY2FyZERhdGEgPSAoQXJyYXkuaXNBcnJheShyYXcpID8gcmF3IDogcmF3Py5yZXN1bHRzIHx8IFtdKS5tYXAoKGRlY2s6IGFueSkgPT4gKHtcbiAgICAgICAgaWQ6IGRlY2suaWQsXG4gICAgICAgIHRpdGxlOiBkZWNrLnRpdGxlLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVjay5kZXNjcmlwdGlvbixcbiAgICAgICAgZmxhc2hjYXJkX2NvdW50OiBkZWNrLmZsYXNoY2FyZF9jb3VudCB8fCAwLFxuICAgICAgICBjcmVhdGVkX2F0OiBkZWNrLmNyZWF0ZWRfYXQsXG4gICAgICAgIHVwZGF0ZWRfYXQ6IGRlY2sudXBkYXRlZF9hdCxcbiAgICAgICAgdHlwZTogJ2ZsYXNoY2FyZCcgYXMgY29uc3QsXG4gICAgICB9KSk7XG4gICAgICBzZXRGbGFzaGNhcmRzKGZsYXNoY2FyZERhdGEpO1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGZsYXNoY2FyZHM6JywgZXJyb3IpO1xuICAgICAgaWYgKGlzVGVzdE1vZGUoKSAmJiAoZXJyb3I/LmNvZGUgPT09ICdFUlJfTkVUV09SSycgfHwgIWVycm9yPy5yZXNwb25zZSkpIHtcbiAgICAgICAgc2V0Rmxhc2hjYXJkcyhbXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXRGbGFzaGNhcmRzKFtdKTtcbiAgICAgIH1cbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0SXNMb2FkaW5nRmxhc2hjYXJkcyhmYWxzZSk7XG4gICAgfVxuICB9LCBbcHJvamVjdElkLCBzdXBwb3J0ZWRUeXBlcywgaXNMb2FkaW5nRmxhc2hjYXJkc10pO1xuICBcbiAgY29uc3QgbG9hZEZpbGVzID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgIGlmICghc3VwcG9ydGVkVHlwZXMuaW5jbHVkZXMoJ2ZpbGVzJykpIHJldHVybjtcbiAgICBpZiAoaXNMb2FkaW5nRmlsZXMpIHJldHVybjtcbiAgICBzZXRJc0xvYWRpbmdGaWxlcyh0cnVlKTtcbiAgICB0cnkge1xuICAgICAgLy8gUHJvamVjdCBkZXRhaWwgaW5jbHVkZXMgdXBsb2FkZWRfZmlsZXNcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IChheGlvc0FwaSBhcyBhbnkpLmdldChgcHJvamVjdHMvJHtwcm9qZWN0SWR9L2ApO1xuICAgICAgY29uc3QgcHJvamVjdCA9IHJlcz8uZGF0YSB8fCB7fTtcbiAgICAgIGNvbnN0IHVwbG9hZGVkID0gQXJyYXkuaXNBcnJheShwcm9qZWN0LnVwbG9hZGVkX2ZpbGVzKSA/IHByb2plY3QudXBsb2FkZWRfZmlsZXMgOiBbXTtcbiAgICAgIGNvbnN0IGZpbGVEYXRhID0gdXBsb2FkZWQubWFwKChmaWxlOiBhbnkpID0+ICh7XG4gICAgICAgIGlkOiBmaWxlLmlkLFxuICAgICAgICBuYW1lOiBmaWxlLm9yaWdpbmFsX25hbWUgfHwgKGZpbGUuZmlsZSA/IFN0cmluZyhmaWxlLmZpbGUpLnNwbGl0KCcvJykucG9wKCkgOiAnJyksXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnJyxcbiAgICAgICAgc2l6ZTogZmlsZS5maWxlX3NpemUsXG4gICAgICAgIGZpbGVfdHlwZTogZmlsZS5jb250ZW50X3R5cGUsXG4gICAgICAgIGNyZWF0ZWRfYXQ6IGZpbGUudXBsb2FkZWRfYXQsXG4gICAgICAgIHR5cGU6ICdmaWxlJyBhcyBjb25zdCxcbiAgICAgIH0pKTtcbiAgICAgIHNldEZpbGVzKGZpbGVEYXRhKTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBmaWxlczonLCBlcnJvcik7XG4gICAgICBpZiAoaXNUZXN0TW9kZSgpICYmIChlcnJvcj8uY29kZSA9PT0gJ0VSUl9ORVRXT1JLJyB8fCAhZXJyb3I/LnJlc3BvbnNlKSkge1xuICAgICAgICBzZXRGaWxlcyhbXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXRGaWxlcyhbXSk7XG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzTG9hZGluZ0ZpbGVzKGZhbHNlKTtcbiAgICB9XG4gIH0sIFtwcm9qZWN0SWQsIHN1cHBvcnRlZFR5cGVzLCBpc0xvYWRpbmdGaWxlc10pO1xuICBcbiAgY29uc3QgbG9hZFN0dWR5TWF0ZXJpYWxzID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgIGlmICghc3VwcG9ydGVkVHlwZXMuaW5jbHVkZXMoJ3N0dWR5TWF0ZXJpYWxzJykpIHJldHVybjtcbiAgICBpZiAoaXNMb2FkaW5nU3R1ZHlNYXRlcmlhbHMpIHJldHVybjtcbiAgICBzZXRJc0xvYWRpbmdTdHVkeU1hdGVyaWFscyh0cnVlKTtcbiAgICB0cnkge1xuICAgICAgLy8gU3R1ZHkgbWF0ZXJpYWxzIGxpdmUgdW5kZXIgbm9uLUFQSSBwcmVmaXhcbiAgICAgIGNvbnN0IHBpZCA9IG5vcm1hbGl6ZVByb2plY3RJZChwcm9qZWN0SWQpO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgKGF4aW9zSW5zdGFuY2UgYXMgYW55KS5nZXQoYC9zdHVkeV9tYXRlcmlhbHMvc3R1ZHlfbWF0ZXJpYWxzL2AsIHtcbiAgICAgICAgcGFyYW1zOiB7IHByb2plY3Q6IHBpZCB9XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHJhdyA9IHJlcz8uZGF0YSA/PyBbXTtcbiAgICAgIGNvbnN0IGxpc3QgPSBBcnJheS5pc0FycmF5KHJhdykgPyByYXcgOiByYXc/LnJlc3VsdHMgfHwgW107XG4gICAgICAvLyBGaWx0ZXIgYnkgcHJvamVjdCBpZiBiYWNrZW5kIGlnbm9yZXMgcXVlcnkgcGFyYW1cbiAgICAgIGNvbnN0IGZpbHRlcmVkID0gbGlzdC5maWx0ZXIoKG06IGFueSkgPT4gIW0ucHJvamVjdCB8fCBTdHJpbmcobS5wcm9qZWN0KSA9PT0gU3RyaW5nKHBpZCkpO1xuICAgICAgY29uc3QgbWF0ZXJpYWxEYXRhID0gZmlsdGVyZWQubWFwKChtYXRlcmlhbDogYW55KSA9PiAoe1xuICAgICAgICBpZDogbWF0ZXJpYWwuaWQsXG4gICAgICAgIHRpdGxlOiBtYXRlcmlhbC50aXRsZSxcbiAgICAgICAgbmFtZTogbWF0ZXJpYWwudGl0bGUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBtYXRlcmlhbC5kZXNjcmlwdGlvbixcbiAgICAgICAgY3JlYXRlZF9hdDogbWF0ZXJpYWwuY3JlYXRlZF9hdCxcbiAgICAgICAgdXBkYXRlZF9hdDogbWF0ZXJpYWwudXBkYXRlZF9hdCxcbiAgICAgICAgdHlwZTogJ3N0dWR5X21hdGVyaWFsJyBhcyBjb25zdCxcbiAgICAgIH0pKTtcbiAgICAgIHNldFN0dWR5TWF0ZXJpYWxzKG1hdGVyaWFsRGF0YSk7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgc3R1ZHkgbWF0ZXJpYWxzOicsIGVycm9yKTtcbiAgICAgIGlmIChpc1Rlc3RNb2RlKCkgJiYgKGVycm9yPy5jb2RlID09PSAnRVJSX05FVFdPUksnIHx8ICFlcnJvcj8ucmVzcG9uc2UpKSB7XG4gICAgICAgIHNldFN0dWR5TWF0ZXJpYWxzKFtdKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldFN0dWR5TWF0ZXJpYWxzKFtdKTtcbiAgICAgIH1cbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0SXNMb2FkaW5nU3R1ZHlNYXRlcmlhbHMoZmFsc2UpO1xuICAgIH1cbiAgfSwgW3Byb2plY3RJZCwgc3VwcG9ydGVkVHlwZXMsIGlzTG9hZGluZ1N0dWR5TWF0ZXJpYWxzXSk7XG5cbiAgY29uc3QgaGFuZGxlRmlsZVVwbG9hZCA9IHVzZUNhbGxiYWNrKGFzeW5jIChmaWxlczogRmlsZVtdKSA9PiB7XG4gICAgc2V0VXBsb2FkZWRGaWxlcyhwcmV2ID0+IFsuLi5wcmV2LCAuLi5maWxlc10pO1xuICAgIHRyeSB7XG4gICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgZmlsZSk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgKGF4aW9zQXBpIGFzIGFueSkucG9zdChgcHJvamVjdHMvJHtwcm9qZWN0SWR9L3VwbG9hZF9maWxlL2AsIGZvcm1EYXRhLCB7XG4gICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGEnIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCB8fCByZXNwb25zZS5zdGF0dXMgPT09IDIwMSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgRmlsZSB1cGxvYWRlZCBzdWNjZXNzZnVsbHk6JywgZmlsZS5uYW1lKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7IGxvYWRGaWxlcygpOyB9LCAxMDAwKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEZpbGUgdXBsb2FkIGZhaWxlZDonLCBlcnJvcik7XG4gICAgfVxuICB9LCBbcHJvamVjdElkLCBsb2FkRmlsZXNdKTtcblxuICBjb25zdCByZW1vdmVVcGxvYWRlZEZpbGUgPSB1c2VDYWxsYmFjaygoaW5kZXg6IG51bWJlcikgPT4ge1xuICAgIHNldFVwbG9hZGVkRmlsZXMocHJldiA9PiBwcmV2LmZpbHRlcigoXywgaSkgPT4gaSAhPT0gaW5kZXgpKTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IHNldFNlbGVjdGVkU291cmNlcyA9IHVzZUNhbGxiYWNrKChzb3VyY2VzOiBTZWxlY3RlZFNvdXJjZXMpID0+IHtcbiAgICBzZXRTZWxlY3RlZFNvdXJjZXNTdGF0ZShzb3VyY2VzKTtcbiAgICBvblNvdXJjZXNDaGFuZ2U/Lihzb3VyY2VzKTtcbiAgfSwgW29uU291cmNlc0NoYW5nZV0pO1xuXG4gIGNvbnN0IGNsZWFyU2VsZWN0aW9uID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHNldFNlbGVjdGVkU291cmNlcyhERUZBVUxUX1NFTEVDVEVEX1NPVVJDRVMpO1xuICAgIHNldFVwbG9hZGVkRmlsZXMoW10pO1xuICAgIHNldFNlYXJjaFRlcm0oJycpO1xuICB9LCBbc2V0U2VsZWN0ZWRTb3VyY2VzXSk7XG5cbiAgY29uc3QgcmVmcmVzaFNvdXJjZXMgPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XG4gICAgaWYgKGlzUmVmcmVzaGluZykgcmV0dXJuO1xuICAgIHNldElzUmVmcmVzaGluZyh0cnVlKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICBsb2FkRmxhc2hjYXJkcygpLFxuICAgICAgICBsb2FkRmlsZXMoKSxcbiAgICAgICAgbG9hZFN0dWR5TWF0ZXJpYWxzKCksXG4gICAgICBdKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0SXNSZWZyZXNoaW5nKGZhbHNlKTtcbiAgICB9XG4gIH0sIFtpc1JlZnJlc2hpbmcsIGxvYWRGbGFzaGNhcmRzLCBsb2FkRmlsZXMsIGxvYWRTdHVkeU1hdGVyaWFsc10pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGF1dG9Mb2FkICYmIHByb2plY3RJZCkge1xuICAgICAgcmVmcmVzaFNvdXJjZXMoKTtcbiAgICB9XG4gIH0sIFthdXRvTG9hZCwgcHJvamVjdElkLCByZWZyZXNoU291cmNlc10pO1xuXG4gIGNvbnN0IHRvdGFsU2VsZWN0ZWRDb3VudCA9IFxuICAgIHNlbGVjdGVkU291cmNlcy5mbGFzaGNhcmRzLmlkcy5sZW5ndGggK1xuICAgIHNlbGVjdGVkU291cmNlcy5maWxlcy5pZHMubGVuZ3RoICtcbiAgICBzZWxlY3RlZFNvdXJjZXMuc3R1ZHlNYXRlcmlhbHMuaWRzLmxlbmd0aCArXG4gICAgdXBsb2FkZWRGaWxlcy5sZW5ndGg7XG4gIFxuICBjb25zdCBoYXNNaW5pbXVtU2VsZWN0aW9uID0gdG90YWxTZWxlY3RlZENvdW50ID49IDE7XG4gIGNvbnN0IGlzQW55TG9hZGluZyA9IGlzTG9hZGluZ0ZsYXNoY2FyZHMgfHwgaXNMb2FkaW5nRmlsZXMgfHwgaXNMb2FkaW5nU3R1ZHlNYXRlcmlhbHM7XG4gIFxuICByZXR1cm4ge1xuICAgIGZsYXNoY2FyZHMsXG4gICAgZmlsZXMsXG4gICAgc3R1ZHlNYXRlcmlhbHMsXG4gICAgdXBsb2FkZWRGaWxlcyxcbiAgICBpc0xvYWRpbmdGbGFzaGNhcmRzLFxuICAgIGlzTG9hZGluZ0ZpbGVzLFxuICAgIGlzTG9hZGluZ1N0dWR5TWF0ZXJpYWxzLFxuICAgIHNlbGVjdGVkU291cmNlcyxcbiAgICBzZWFyY2hUZXJtLFxuICAgIHNldFNlbGVjdGVkU291cmNlcyxcbiAgICBzZXRTZWFyY2hUZXJtLFxuICAgIGhhbmRsZUZpbGVVcGxvYWQsXG4gICAgcmVtb3ZlVXBsb2FkZWRGaWxlLFxuICAgIHJlZnJlc2hTb3VyY2VzLFxuICAgIGNsZWFyU2VsZWN0aW9uLFxuICAgIHRvdGFsU2VsZWN0ZWRDb3VudCxcbiAgICBoYXNNaW5pbXVtU2VsZWN0aW9uLFxuICAgIGlzQW55TG9hZGluZyxcbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHVzZU11bHRpU291cmNlTWFuYWdlbWVudDtcbiJdLCJuYW1lcyI6WyJ1c2VNdWx0aVNvdXJjZU1hbmFnZW1lbnQiLCJERUZBVUxUX1NFTEVDVEVEX1NPVVJDRVMiLCJmbGFzaGNhcmRzIiwiaWRzIiwiZ3JvdW5kT25seSIsImZpbGVzIiwic3R1ZHlNYXRlcmlhbHMiLCJERUZBVUxUX1NVUFBPUlRFRF9UWVBFUyIsInByb2plY3RJZCIsInN1cHBvcnRlZFR5cGVzIiwib25Tb3VyY2VzQ2hhbmdlIiwiYXV0b0xvYWQiLCJzZXRGbGFzaGNhcmRzIiwidXNlU3RhdGUiLCJzZXRGaWxlcyIsInNldFN0dWR5TWF0ZXJpYWxzIiwidXBsb2FkZWRGaWxlcyIsInNldFVwbG9hZGVkRmlsZXMiLCJpc0xvYWRpbmdGbGFzaGNhcmRzIiwic2V0SXNMb2FkaW5nRmxhc2hjYXJkcyIsImlzTG9hZGluZ0ZpbGVzIiwic2V0SXNMb2FkaW5nRmlsZXMiLCJpc0xvYWRpbmdTdHVkeU1hdGVyaWFscyIsInNldElzTG9hZGluZ1N0dWR5TWF0ZXJpYWxzIiwiaXNSZWZyZXNoaW5nIiwic2V0SXNSZWZyZXNoaW5nIiwic2VsZWN0ZWRTb3VyY2VzIiwic2V0U2VsZWN0ZWRTb3VyY2VzU3RhdGUiLCJzZWFyY2hUZXJtIiwic2V0U2VhcmNoVGVybSIsImxvYWRGbGFzaGNhcmRzIiwidXNlQ2FsbGJhY2siLCJpbmNsdWRlcyIsInJlc3BvbnNlIiwiZ2V0UHJvamVjdFNjb3BlZCIsInJhdyIsImRhdGEiLCJmbGFzaGNhcmREYXRhIiwiQXJyYXkiLCJpc0FycmF5IiwicmVzdWx0cyIsIm1hcCIsImRlY2siLCJpZCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJmbGFzaGNhcmRfY291bnQiLCJjcmVhdGVkX2F0IiwidXBkYXRlZF9hdCIsInR5cGUiLCJlcnJvciIsImNvbnNvbGUiLCJpc1Rlc3RNb2RlIiwiY29kZSIsImxvYWRGaWxlcyIsInJlcyIsImF4aW9zQXBpIiwiZ2V0IiwicHJvamVjdCIsInVwbG9hZGVkIiwidXBsb2FkZWRfZmlsZXMiLCJmaWxlRGF0YSIsImZpbGUiLCJuYW1lIiwib3JpZ2luYWxfbmFtZSIsIlN0cmluZyIsInNwbGl0IiwicG9wIiwic2l6ZSIsImZpbGVfc2l6ZSIsImZpbGVfdHlwZSIsImNvbnRlbnRfdHlwZSIsInVwbG9hZGVkX2F0IiwibG9hZFN0dWR5TWF0ZXJpYWxzIiwicGlkIiwibm9ybWFsaXplUHJvamVjdElkIiwiYXhpb3NJbnN0YW5jZSIsInBhcmFtcyIsImxpc3QiLCJmaWx0ZXJlZCIsImZpbHRlciIsIm0iLCJtYXRlcmlhbERhdGEiLCJtYXRlcmlhbCIsImhhbmRsZUZpbGVVcGxvYWQiLCJwcmV2IiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsImFwcGVuZCIsInBvc3QiLCJoZWFkZXJzIiwic3RhdHVzIiwibG9nIiwic2V0VGltZW91dCIsInJlbW92ZVVwbG9hZGVkRmlsZSIsImluZGV4IiwiXyIsImkiLCJzZXRTZWxlY3RlZFNvdXJjZXMiLCJzb3VyY2VzIiwiY2xlYXJTZWxlY3Rpb24iLCJyZWZyZXNoU291cmNlcyIsIlByb21pc2UiLCJhbGwiLCJ1c2VFZmZlY3QiLCJ0b3RhbFNlbGVjdGVkQ291bnQiLCJsZW5ndGgiLCJoYXNNaW5pbXVtU2VsZWN0aW9uIiwiaXNBbnlMb2FkaW5nIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0NBTUM7Ozs7Ozs7Ozs7O0lBZ1NELE9BQXdDO2VBQXhDOztJQXhNYUEsd0JBQXdCO2VBQXhCQTs7O3VCQXRGb0M7K0RBQ1Q7MkJBQ0w7NEJBQ0Y7NkJBQ047Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWtFM0IsK0VBQStFO0FBQy9FLGlCQUFpQjtBQUNqQiwrRUFBK0U7QUFFL0UsTUFBTUMsMkJBQTRDO0lBQ2hEQyxZQUFZO1FBQUVDLEtBQUssRUFBRTtRQUFFQyxZQUFZO0lBQU07SUFDekNDLE9BQU87UUFBRUYsS0FBSyxFQUFFO1FBQUVDLFlBQVk7SUFBTTtJQUNwQ0UsZ0JBQWdCO1FBQUVILEtBQUssRUFBRTtRQUFFQyxZQUFZO0lBQU07QUFDL0M7QUFFQSxNQUFNRywwQkFBNEU7SUFBQztJQUFjO0lBQVM7Q0FBaUI7QUFNcEgsTUFBTVAsMkJBQTJCLENBQUMsRUFDdkNRLFNBQVMsRUFDVEMsaUJBQWlCRix1QkFBdUIsRUFDeENHLGVBQWUsRUFDZkMsV0FBVyxJQUFJLEVBQ2lCO0lBQ2hDLE1BQU0sQ0FBQ1QsWUFBWVUsY0FBYyxHQUFHQyxJQUFBQSxlQUFRLEVBQWUsRUFBRTtJQUM3RCxNQUFNLENBQUNSLE9BQU9TLFNBQVMsR0FBR0QsSUFBQUEsZUFBUSxFQUFlLEVBQUU7SUFDbkQsTUFBTSxDQUFDUCxnQkFBZ0JTLGtCQUFrQixHQUFHRixJQUFBQSxlQUFRLEVBQWUsRUFBRTtJQUNyRSxNQUFNLENBQUNHLGVBQWVDLGlCQUFpQixHQUFHSixJQUFBQSxlQUFRLEVBQVMsRUFBRTtJQUU3RCxNQUFNLENBQUNLLHFCQUFxQkMsdUJBQXVCLEdBQUdOLElBQUFBLGVBQVEsRUFBQztJQUMvRCxNQUFNLENBQUNPLGdCQUFnQkMsa0JBQWtCLEdBQUdSLElBQUFBLGVBQVEsRUFBQztJQUNyRCxN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